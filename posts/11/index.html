
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>乐者为王</title>
  <meta name="author" content="dohkoos">

  
  <meta name="description" content="收集了网上的一些CSS命名规范，根据自己的理解和需求整理了一遍。 布局（layout） container 就是将页面中的所有元素包在一起的部分
header 页面的头部区域，包含站点的logo和一些其他元素
navbar 横向导航栏，最典型的网页元素
breadcrumbs &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://codemany.com/posts/11/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="乐者为王" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46570161-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">乐者为王</a></h1>
  
    <h2>Do one thing, and do it well.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="codemany.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/css-naming-conventions/">CSS命名规范</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-28T18:27:06+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>6:27 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>收集了网上的一些CSS命名规范，根据自己的理解和需求整理了一遍。</p>

<h3 id="布局（layout）">布局（layout）</h3>

<ul>
<li>container 就是将页面中的所有元素包在一起的部分</li>
<li>header 页面的头部区域，包含站点的logo和一些其他元素</li>
<li>navbar 横向导航栏，最典型的网页元素</li>
<li>breadcrumbs 即页面所处位置的导航提示</li>
<li>content 是站点的主要区域</li>
<li>sidebar</li>
<li>footer</li>
</ul>

<h3 id="头部（header）">头部（header）</h3>

<ul>
<li>logo</li>
<li>slogan</li>
</ul>

<h3 id="导航栏（navbar）">导航栏（navbar）</h3>

<ul>
<li>mainnav</li>
<li>subnav</li>
<li>topnav</li>
</ul>

<h3 id="侧边栏（sidebar）">侧边栏（sidebar）</h3>

<ul>
<li>menu 包含一般的链接。sidebar中可以包含多个menu</li>
</ul>

<h3 id="常用">常用</h3>

<ul>
<li>userbar 登录注册条</li>
<li>copyright</li>
<li>banner</li>
<li>feature</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/binary-search-algorithm-i-wrote-has-a-bug/">我写的二分查找算法有bug！</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-25T08:07:17+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>8:07 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>看完 <a href="http://reprog.wordpress.com/2010/04/19/are-you-one-of-the-10-percent/">http://reprog.wordpress.com/2010/04/19/are-you-one-of-the-10-percent/</a> 觉得很不服气，写个二分查找算法还不简单吗？分分钟搞定的事情。</p>

<p>按照它的要求，用Java写出以下代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public int binarySearch(int[] array, int value) {
</span><span class='line'>    int low = 0;
</span><span class='line'>    int high = array.length - 1;
</span><span class='line'>    int mid;
</span><span class='line'>    while (low &lt;= high) {
</span><span class='line'>        mid = (low + high) / 2;
</span><span class='line'>        if (array[mid] &lt; value) {
</span><span class='line'>            low = mid + 1;
</span><span class='line'>        } else if (array[mid] &gt; value) {
</span><span class='line'>            high = mid - 1;
</span><span class='line'>        } else {
</span><span class='line'>            return mid;
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    return -1;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

<p>把代码贴到评论区参加测试。</p>

<p>写代码和检查总共花费20分钟，75%的时间是用来在脑袋里模拟运算，防止数组索引溢出。然后编译2次，消除了两个语法错误（好久没写Java代码和使用Ruby的关系，竟然连个数组初始化都不会写了）。也想过数值溢出的问题，但是没想到点子上。结果恰恰倒在了这个地方。具体原因在 <a href="http://googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html">http://googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html</a> 有描述。因为low + high的和会形成数值溢出，解决方法是采用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int mid = low + ((high - low) / 2);</span></code></pre></td></tr></table></div></figure>

<p>或</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int mid = (low + high) &gt;&gt;&gt; 1;</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/how-to-crack-zte-zxa10-f460-v30-for-superuser-password/">如何破解中兴ZXA10-F460 v3.0获取超级管理员密码</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-20T14:12:59+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>2:12 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>破解前的系统情况：</p>

<ul>
<li>硬件版本号 V3.0</li>
<li>软件版本号 F460_IMS_V2.30.10P1T6_JS1111</li>
<li>BOOT版本号 V1.1.0P1T1</li>
<li>版本日期 2012-02-29 16:29:07</li>
</ul>

<p>中兴ZXA10-F460光猫（E8-C）在第一次安装的时候，超级管理员帐号是telecomadmin，密码为nE7jA%5m，这个是默认的，由安装人员设置好相关设置后，会自动下载配置，这时候这个超级管理员密码会被修改为telecomadminXXXXXXXX（8个X是8位数字，每个用户是不同的）这种格式。因为很多设置需要在超级管理员下才能设置，所以破解这个超级管理员密码是非常必要的。</p>

<p>其中V1.0和V2.0版本网上有破解方法，大家可以自己搜索。</p>

<p>在命令行下输入telnet 192.168.1.1，帐号和密码都是root。连接成功后，会出现“F460 login:”这样的提示。</p>

<p>注意：目前网上流传的查看/tmp目录下db_backup_cfg.xml文件内容的破解方法已经无效了。另外在/userconfig/cfg目录下有两个加密的配置文件db_backup_cfg.xml和db_user_cfg.xml，同目录下还有个db_default_cfg.xml是不加密的（该文件是出厂设置的配置文件），但是大家不要用这个文件去替换db_user_cfg.xml，否则会出现不可预知的后果。</p>

<p>实际上只要修改一下/home/httpd/login.gch这个文件，就能看到密码了。patch文件内容如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>--- /home/httpd/login.gch 2012-07-03 14:05:16.000000000 +0800
</span><span class='line'>+++ login.gch 2012-07-03 14:03:37.000000000 +0800
</span><span class='line'>@@ -152,6 +152,17 @@
</span><span class='line'>set_language("langcn.conf");
</span><span class='line'>langclass = "login_title_centeren";
</span><span class='line'>}
</span><span class='line'>+var CK_HANDLE = create_paralist();
</span><span class='line'>+var login_name = "telecomadmin";
</span><span class='line'>+set_para(CK_HANDLE, "Username", login_name);
</span><span class='line'>+qeury_list_bycond("OBJ_USERINFO_ID", "IGD", CK_HANDLE);
</span><span class='line'>+destroy_paralist(CK_HANDLE);
</span><span class='line'>+CK_HANDLE = create_paralist();
</span><span class='line'>+var CK_IDENTITY = query_identity(0);
</span><span class='line'>+get_inst(CK_HANDLE, "OBJ_USERINFO_ID", CK_IDENTITY);
</span><span class='line'>+var now_pwd = get_para(CK_HANDLE, "Password");
</span><span class='line'>+now_pwd = delMoreSlash(now_pwd);
</span><span class='line'>+destroy_paralist(CK_HANDLE);
</span><span class='line'>%&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>&lt;META HTTP-EQUIV="pragma" CONTENT="no-cache&gt;
</span><span class='line'>@@ -239,4 +250,5 @@
</span><span class='line'>&lt;/script&gt;
</span><span class='line'>&lt;/head&gt;
</span><span class='line'>&lt;body onload="onFocus();"&gt;
</span><span class='line'>+&lt;div&gt;&lt;%=now_pwd;%&gt;&lt;/div&gt;
</span><span class='line'>&lt;div id="container" class="content"&gt;</span></code></pre></td></tr></table></div></figure>

<p>效果是浏览器登录192.168.1.1的时候，超级管理员密码会显示在首页界面的左上角。</p>

<p>到这儿有人想了，怎么把上面的patch更新到/home/httpd/login.gch中呢？总结了三种方法：</p>

<p>第一种方法是telent到F460上后，执行下面的命令即可：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sed -i '155 s/^/var CK_HANDLE = create_paralist();\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '156 s/^/var login_name = "telecomadmin";\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '157 s/^/set_para(CK_HANDLE, "Username", login_name);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '158 s/^/qeury_list_bycond("OBJ_USERINFO_ID", "IGD", CK_HANDLE);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '159 s/^/destroy_paralist(CK_HANDLE);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '160 s/^/CK_HANDLE = create_paralist();\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '161 s/^/var CK_IDENTITY = query_identity(0);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '162 s/^/get_inst(CK_HANDLE, "OBJ_USERINFO_ID", CK_IDENTITY);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '163 s/^/var now_pwd = get_para(CK_HANDLE, "Password");\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '164 s/^/now_pwd = delMoreSlash(now_pwd);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '165 s/^/destroy_paralist(CK_HANDLE);\n/' /home/httpd/login.gch
</span><span class='line'>sed -i '253 s/^/&lt;div&gt;&lt;%=now_pwd;%&gt;&lt;\/div&gt;\n/' /home/httpd/login.gch</span></code></pre></td></tr></table></div></figure>

<p>第二种方法是telent到F460上后，执行cp /home/httpd/login.gch /home/httpd/login_gch.xml，通过浏览器把login_gch.xml保存到电脑上，然后再把patch更新进去。可以在电脑上架设ftp服务器，在F460上执行以下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /home/httpd/
</span><span class='line'>wget ftp://&lt;YOUR_COMPUTER_IP&gt;/login.gch  # 把&lt;YOUR_COMPUTER_IP&gt;替换成你自己的</span></code></pre></td></tr></table></div></figure>

<p>第三种方法是telent到F460上后，执行df命令，查看是否有usb1_1或usb2_1，如果有就可以进行下一步操作。输入cp /home/httpd/login.gch /mnt/usb1_1/login.gch把文件拷贝到优盘上，修改后使用cp /mnt/usb1_1/login.gch /home/httpd/login.gch把文件更新到猫上就可以。</p>

<p>2013/6/16更新</p>

<p>其实还有种更简便的方法，中兴的光猫有个sendcmd命令，下面是该命令的简单用法：</p>

<ol>
<li>读取全部表名 sendcmd 1 DB all；</li>
<li>读取指定表信息 sendcmd 1 DB p 表名。比如sendcmd 1 DB p UserInfo，查看路由器帐号和密码，超级管理员密码也在这里查看；</li>
<li>查看当前系统运行的服务状态 sendcmd -pc show；</li>
<li>修改某个表的某个字段的值 sendcmd 1 DB set 表名 行数 字段名 字段值。比如要修改超级管理员密码，可以使用sendcmd 1 DB set UserInfo 0 Password 123456；</li>
<li>保存对配置文件的修改 sendcmd 1 DB save。</li>
</ol>

<p>当然还有其它的命令，但是就修改光猫配置来说，这几条命令足够了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/summary-of-sql-join/">SQL连接总结</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-07-02T09:44:51+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2012</span></span> <span class='time'>9:44 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>连接（join）可以在SELECT语句的FROM子句或WHERE子句中建立，在FROM子句中指出连接时有助于将连接操作与WHERE子句中的搜索条件区分开来。连接可以对同一个表操作，也可以对多个表操作，对同一个表操作的连接称为自连接（self join）。</p>

<p>连接类型（join type）分为三种：内连接、外连接和交叉连接。</p>

<ul>
<li>内连接（inner join）：使用比较运算符进行表间某（些）列数据的比较操作，并列出这些表中与连接条件相匹配的数据行。</li>
<li>外连接（outer join）：与内连接不同的是外连接不只列出与连接条件相匹配的行，而且列出左表（左外连接时）、右表（右外连接时）或两个表（全外连接时）中所有符合条件的数据行。</li>
<li>交叉连接（cross join）：返回连接表中所有数据行的笛卡尔积。</li>
</ul>

<p>内/外链接可以分为等值连接和不等连接：</p>

<ul>
<li>等值连接（equijoin）：在连接条件中使用等于（=）运算符比较被连接列的列值，其查询结果中列出被连接表中的所有列，包括其中的重复列。</li>
<li>不等连接（non-equijoin）：在连接条件使用除等于运算符以外的其它比较运算符比较被连接的列的列值。</li>
</ul>

<p>注意：自然连接（natural join）是一种特殊的等值连接。它使用选择列表指出查询结果中所包括的列，由此删除连接表中的重复列。</p>

<p>books数据表：</p>

<p><img src="/uploads/books-table.png" title="books-table" ></p>

<p>publishers数据表：</p>

<p><img src="/uploads/publishers-table.png" title="publishers-table" ></p>

<p>自连接查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM books b1 [INNER] JOIN books b2 ON b1.price = b2.price</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/self-join.png" title="self-join" ></p>

<p>内连接（简称连接）查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM books b [INNER] JOIN publishers p ON b.publisher_id = p.publisher_id</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/inner-join.png" title="inner-join" ></p>

<p>自然连接查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT b.*, p.name FROM books b [INNER] JOIN publishers p ON b.publisher_id = p.publisher_id</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/natural-join.png" title="natural-join" ></p>

<p>左外连接（简称左连接）查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM books b LEFT [OUTER] JOIN publishers p ON b.publisher_id = p.publisher_id</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/left-outer-join.png" title="left-outer-join" ></p>

<p>右外连接（简称右连接）查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM books b RIGHT [OUTER] JOIN publishers p ON b.publisher_id = p.publisher_id</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/right-outer-join.png" title="right-outer-join" ></p>

<p>全外连接（简称全连接）查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM books b FULL [OUTER] JOIN publishers p ON b.publisher_id = p.publisher_id</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/full-outer-join.png" title="full-outer-join" ></p>

<p>交叉连接查询：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SELECT * FROM books CROSS JOIN publishers</span></code></pre></td></tr></table></div></figure>

<p><img src="/uploads/cross-join.png" title="cross-join" ></p>

<p>下图是由Moffatt在2008年制作的连接集合表示：</p>

<p><img src="/uploads/sql-joins.jpg" title="sql-joins" ></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/in-startups-and-life-you-need-plan-a-b-and-z/">在创业和生活中间你需要计划A、B和Z</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-06-11T18:20:17+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>6:20 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>英文原文：<a href="https://techcrunch.com/2012/02/14/in-startups-and-life-you-need-plan-a-b-and-z/">https://techcrunch.com/2012/02/14/in-startups-and-life-you-need-plan-a-b-and-z/</a></p>

<p>创业者总会从真正聪明的、有经验的人士那里得到很多矛盾的建议。例如，你可能被告知既要坚持又要灵活；要有一个你不懈地追求的清晰愿景，但是也要随着市场的变化而改变你的愿景。简单，对吧？</p>

<p>同样的矛盾在职业咨询当中盛行。有些人会告诉你，要想清楚十年后你希望在哪里，然后通过逆向推导，建立一个实现你的雄心的长期职业规划。其他人告诉你，坚定的计划就像一种桎梏：它们会让你错失意想不到的突破机会。他们说，最好是保持随机应变。</p>

<p>谁是对的呢？两者不仅都是对的，而且至关重要。创业者需要灵活性地坚持。我曾经共事过的优秀创业者忙于重要的规划与战略，但他们不会设置固定的计划。在我和Ben Casnocha的新书<a href="https://www.amazon.com/Start-up-You-Future-Yourself-Transform/dp/0307888908/">《The Start-Up of You: Adapt to the Future, Invest in Yourself, and Transform Your Career》</a>中，我们展示了任何专业人士如何将创业技巧应用于他们的职业，即使你从未计划去求职于一家公司。</p>

<p>我参与过一些在它们初创时你不会认可的公司。尤其是作为很好例子的两个，因为它们都有着巨大的影响力：Flickr和PayPal。Flickr开始时是一个多玩家在线游戏，之后渐变为最广泛使用的照片托管和分享网站之一。PayPal开始时是移动电话的加密平台，然后成为Palm Pilot之间的转钱服务，最终成为领先的在线支付公司。两者都坚持它们最初的愿景，以求学习和成长：Flickr作为一种社交体验和PayPal是安全的现金。然而，正是因为有着极大的弹性和锲而不舍，两家公司都彻底地改变了产品的类型并最终获得用户的青睐。</p>

<p>在创业或职业生涯中，你是如何做到灵活地坚持的？这里是我使用的一个框架：ABZ计划。在事业和生活中，你应该有3个计划：A计划、B计划和Z计划。</p>

<p><strong>A计划</strong>是你当前的计划，你目前的重点是怎样赢得市场。对于Flickr的联合创始人<a href="http://www.linkedin.com/in/cefake">Caterina Fake</a>和<a href="http://ca.linkedin.com/in/butterfield">Stewart Butterfield</a>而言，最初的A计划是Game Neverending，一个多玩家在线游戏。不同于当时的大多数游戏只能通过固定的体验在几个对手之间进行，他们希望他们的游戏能有数以百计的用户同时玩，并且永远地在游戏中创造新的事物。为了吸引住用户，他们构建了像群组、即时通讯这样的社交功能，最关键的功能是允许玩家彼此之间分享照片。</p>

<p>我最初的职业A计划是致力于学术界，因为我认为传播什么是造就一个良好社会的思想是对这个世界造成影响的最好方式。当我在牛津学习时，我学到很多关于人们如何聚在一起，在群组间互动和与社会产生关联。但是我也了解到，学术界的职业成功往往意味着写出只有50多人读过的专业著作。</p>

<p><strong>B计划</strong>是当你意识到一个新机会比你所从事的事情拥有更多潜力时转向的计划。有时候你转变为B计划是因为A计划并不奏效，这是大多数人听到“B计划”时所想的。但有时候A计划还能正常工作，然而B计划似乎拥有更多潜力。不管转移的原因是什么，最好的B计划是虽有不同，但却和你现在正在做的事情有关。这样，你可以把你已经学到的经验和教训用于新计划。</p>

<p>对照到Flickr，出乎意料地，照片分享功能受欢迎的程度超越了游戏本身。Caterina和Stewart面临一个抉择：他们应该坚持他们的A计划还是暂时中止游戏（和2万狂热用户）以便完全专注于照片分享功能？最终他们转移到B计划。当然，Caterina和Stewart仍然遵循最初的想法来构建一个在线的社交空间——他们只是看到照片分享比游戏有更大的潜力。</p>

<p>在我的职业生涯中，我对学术界的认识导致我转向B计划，找到具有更广泛影响力的职业路径。我的B计划是创建新的软件。软件行业的成功也意味着“影响力”——但是比学术界有更广泛的规模。在某些情况下，它意味着构建一种每天改善数百万人生活的产品。为追求这条替代路线，我首先通过在苹果和富士通的在线部门工作来专注于建立相关技能和关系。其次，我与可以共同创建一家我自己的公司的人联系。然后，当我开始我的第一家公司时，我招募了许多聪明的顾问和参与者，以便快速地学习和调整。而且，就公司规划方面来说，由于我的第一家公司（SocialNet）不成功，PayPal和LinkedIn都是我自己转向的新的B计划。</p>

<p>请记住，你应该很少写下一个明确的B计划，但是你应该总是在你执行你的A计划时注意你的动态参数。你应该考虑“临近可能性”。你的可转换的技能。在视野内的其它机会。</p>

<p><strong>Z计划</strong>有两个关键的部分。首先，确认如何衡量你正在朝着最坏的情况发展，其次，它是告诉你最坏的情况发生时应该做什么。也许当你的信用卡债务膨胀到一定数量时，你会提前支取你的401k养老金，或者在星巴克找份工作。Z计划最后担保的确定性就是让你在职业生涯中承担各种不确定性和风险。当我开始我的第一家公司SocialNet时，我的父母在他们的住宅为我提供了一间屋子，以防事情没有成功。住在那里然后找其它的工作是我的Z计划。它让我有信心全身心地投入到事业中，因为我知道就算一切都没有了，我也不至于沦落街头。为了可以重新开始，你需要在失败中存活。</p>

<p>TechCrunch读者每天都会看到一些成功公司的适应性路径。然而，很少人会将这种适应性手册应用于自己的生活。像ABZ规划这样的框架可以帮助你掌控你的职业生涯。我们应该记住的是，无论我们开始创业，在初创公司工作，或者在大公司工作：最终的创业者是你。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/how-to-avoid-browser-open-the-file-automatically-when-click-link-to-download-file/">如何避免点击链接下载文件时浏览器自动打开文件</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-06-03T07:26:02+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2012</span></span> <span class='time'>7:26 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>HTTP Response Header有个Content-Disposition参数，该参数的目的是为了在客户端另存文件时提供一个建议的文件名。将它的值设置为attachment后，浏览器就会老老实实地显示另存为对话框，如果这个值设成inline，则无论怎样浏览器都会自动尝试用已知关联的程序打开文件。</p>

<p>注意：在Firefox中需要把filename用双引号包起来才能得到想要的文件名，不然如果含有空格就会丢掉空格后面的部分，而IE会把空格转为下划线。</p>

<p>Java设置header代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>res.addHeader("Content-Disposition", "attachment; filename=" + res.encodeURL(filename));</span></code></pre></td></tr></table></div></figure>

<p>Ruby设置header代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>headers['Content-Disposition'] = "attachment; filename=#{filename}"</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/how-to-avoid-the-project-is-always-90-percent-done/">如何避免项目总是完成90%</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-05-19T14:23:25+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>2:23 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>程序员经常会说“功能已经基本完成，接下来只需要花点时间进行扫尾工作即可，但这些基本都是些小事情，我已经完成了90%。”但实际情况是项目进度总是延迟。这里最最根本的问题是什么？这个程序员并没有一个清单，把自己要做的所有事情都列出来。这就意味着，即使他坚信自己已经完成90%的工作，他还是不知道这个项目什么时候可以做完，他的时间表是没有真实依据的。</p>

<p>一个好的软件项目经理的任务就是，鼓励并且强制要求程序员创建一张他们所要做的全部事情的列表。然后再为其中的每一项列出子项，并且尽可能把所有的子项都加进来。一旦你拥有了这么一个包含所有事项的列表，你就可以开始估算这个任务需要花费多少时间了。</p>

<p>以下是避免“总是完成90%”问题的发生的几点建议：</p>

<ol>
<li>把项目中所有要做的事情全部罗列出来做成列表。</li>
<li>估算这个列表中每一项所需要花费的时间。这种最初的估算可以帮助你知道整个项目大致要花费多少时间。</li>
<li>如果列表中有一项的时间花费超过1天，则把这项拆分成若干小项。这种将大任务拆分成小任务的方式是解决“总是完成90%”问题的关键步骤。</li>
<li>使用一种呈现任务状态的方式，以便那些感兴趣的人可以了解项目进度。</li>
<li>既然你已经拥有很多小的任务，并且这些任务所消耗的时间都在1天以内，你就可以每天追踪自己的任务完成情况。</li>
</ol>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/notes-rewrite-generator-from-rails-2x-to-rails-3x/">改写Rails 2.x generator到Rails 3.x时的一些记录</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-05-03T07:13:58+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2012</span></span> <span class='time'>7:13 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>因为有个基于Rails 2.x的项目用到了<a href="https://github.com/jsboulanger/feedback">feedback</a>插件，在把项目迁移到Rails 3.x版本后，需要让feedback也支持Rails 3.x。但是原作者早已不再更新该插件，所以只能自己动手。花了两天时间查找资料，修改代码，终于完成。</p>

<p>Rails 3.x中生成generator可用下面的命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rails g generator feedback_form
</span><span class='line'>      create  lib/generators/feedback_form
</span><span class='line'>      create  lib/generators/feedback_form/feedback_form_generator.rb
</span><span class='line'>      create  lib/generators/feedback_form/USAGE
</span><span class='line'>      create  lib/generators/feedback_form/templates</span></code></pre></td></tr></table></div></figure>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class InitializerGenerator &lt; Rails::Generators::NamedBase
</span><span class='line'>  source_root File.expand_path("../templates", __FILE__)
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>

<p>生成基类也从Rails::Generators::Base变成了Rails::Generators::NamedBase。它们的区别是Rails::Generators::NamedBase期望至少一个参数。</p>

<p>USAGE文件里的内容是输入-h选项时显示的文档：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rails generate feedback_form --help
</span><span class='line'>Usage:
</span><span class='line'>  rails generate feedback_form NAME [options]</span></code></pre></td></tr></table></div></figure>

<p>Rails 2.x中的manifest可以删除了，因为在3.x的generator中每个public方法在生成过程中会被自动调用。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/using-rails-32-to-create-a-simple-accounting-application/">用Rails 3.2打造简单记账应用</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-04-18T07:49:27+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>7:49 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Rails已经到3.2版本了，和以前的2.3版本有了很大的不同，决定把原来老版本的记账应用重新写一遍，更新部分插件。</p>

<p>首先是创建项目：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rails new qianbao
</span><span class='line'>cd qianbao
</span><span class='line'>rails g scaffold entry amount:decimal tags:string comment:text effective_date:date
</span><span class='line'>rails g controller home index</span></code></pre></td></tr></table></div></figure>

<p>删除public/index.html，在config/routes.rb中添加根路由：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root :to =&gt; 'home#index'</span></code></pre></td></tr></table></div></figure>

<p>现在要给应用加上一个认证系统（注册、激活、登录、登出），这次使用<a href="https://github.com/plataformatec/devise">devise</a>插件实现。</p>

<p>在Gemfile中添加：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem 'devise'</span></code></pre></td></tr></table></div></figure>

<p>然后执行下列命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bundle install
</span><span class='line'>rails g devise:install
</span><span class='line'>rails g devise user
</span><span class='line'>rails g devise:views</span></code></pre></td></tr></table></div></figure>

<p>创建一个迁移任务，把User和Entry模型关联起来：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class AddUserIdToEntries &lt; ActiveRecord::Migration
</span><span class='line'>  def change
</span><span class='line'>    add_column :entries, :user_id, :integer
</span><span class='line'>
</span><span class='line'>    add_index :entries, :user_id
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>

<p>修改Entry和User模型：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Entry &lt; ActiveRecord::Base
</span><span class='line'>  validates :effective_date, :presence =&gt; true
</span><span class='line'>  validates :amount,         :presence =&gt; true,
</span><span class='line'>                             :numericality =&gt; { :greater_than =&gt; 0.0 },
</span><span class='line'>                             :format =&gt; { :with =&gt; /^\d+??(?:\.\d{0,2})?$/ }
</span><span class='line'>  validates :tags,           :presence =&gt; true,
</span><span class='line'>                             :length =&gt; { :within =&gt; 1..255 }
</span><span class='line'>
</span><span class='line'>  belongs_to :user</span></code></pre></td></tr></table></div></figure>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class User &lt; ActiveRecord::Base
</span><span class='line'>  has_many :entries</span></code></pre></td></tr></table></div></figure>

<p>修改app/views/layouts/application.html.erb文件：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;body&gt;
</span><span class='line'>  &lt;% if user_signed_in? %&gt;
</span><span class='line'>    &lt;p&gt;
</span><span class='line'>      &lt;strong&gt;&lt;%= link_to current_user.email, edit_user_registration_path %&gt;&lt;/strong&gt;
</span><span class='line'>      &lt;%= link_to 'Logout', destroy_user_session_path, :method =&gt; :delete %&gt;
</span><span class='line'>    &lt;/p&gt;
</span><span class='line'>    &lt;%= link_to "All Entries", entries_path %&gt;
</span><span class='line'>  &lt;% else %&gt;
</span><span class='line'>    &lt;p&gt;
</span><span class='line'>      &lt;strong&gt;You are currently not logged in.&lt;/strong&gt;
</span><span class='line'>      &lt;%= link_to 'Sign in', new_user_session_path %&gt; or
</span><span class='line'>      &lt;%= link_to 'Sign up', new_user_registration_path %&gt;
</span><span class='line'>    &lt;/p&gt;
</span><span class='line'>  &lt;% end %&gt;
</span><span class='line'>
</span><span class='line'>  &lt;%= yield %&gt;
</span><span class='line'>&lt;/body&gt;</span></code></pre></td></tr></table></div></figure>

<p>修改app/controller/entries_controller.rb：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class EntriesController &lt; ApplicationController
</span><span class='line'>  before_filter :authenticate_user!
</span><span class='line'>
</span><span class='line'>  # GET /entries
</span><span class='line'>  # GET /entries.json
</span><span class='line'>  def index
</span><span class='line'>    @entries = current_user.entries
</span><span class='line'>
</span><span class='line'>    respond_to do |format|
</span><span class='line'>      format.html # index.html.erb
</span><span class='line'>      format.json { render json: @entries }
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # GET /entries/1
</span><span class='line'>  # GET /entries/1.json
</span><span class='line'>  def show
</span><span class='line'>    @entry = current_user.entries.find(params[:id])
</span><span class='line'>
</span><span class='line'>    respond_to do |format|
</span><span class='line'>      format.html # show.html.erb
</span><span class='line'>      format.json { render json: @entry }
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # GET /entries/new
</span><span class='line'>  # GET /entries/new.json
</span><span class='line'>  def new
</span><span class='line'>    @entry = Entry.new
</span><span class='line'>
</span><span class='line'>    respond_to do |format|
</span><span class='line'>      format.html # new.html.erb
</span><span class='line'>      format.json { render json: @entry }
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # GET /entries/1/edit
</span><span class='line'>  def edit
</span><span class='line'>    @entry = current_user.entries.find(params[:id])
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # POST /entries
</span><span class='line'>  # POST /entries.json
</span><span class='line'>  def create
</span><span class='line'>    @entry = Entry.new(params[:entry])
</span><span class='line'>    @entry.user = current_user
</span><span class='line'>
</span><span class='line'>    respond_to do |format|
</span><span class='line'>      if @entry.save
</span><span class='line'>        format.html { redirect_to @entry, notice: 'Entry was successfully created.' }
</span><span class='line'>        format.json { render json: @entry, status: :created, location: @entry }
</span><span class='line'>      else
</span><span class='line'>        format.html { render action: "new" }
</span><span class='line'>        format.json { render json: @entry.errors, status: :unprocessable_entity }
</span><span class='line'>      end
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # PUT /entries/1
</span><span class='line'>  # PUT /entries/1.json
</span><span class='line'>  def update
</span><span class='line'>    @entry = current_user.entries.find(params[:id])
</span><span class='line'>
</span><span class='line'>    respond_to do |format|
</span><span class='line'>      if @entry.update_attributes(params[:entry])
</span><span class='line'>        format.html { redirect_to @entry, notice: 'Entry was successfully updated.' }
</span><span class='line'>        format.json { head :no_content }
</span><span class='line'>      else
</span><span class='line'>        format.html { render action: "edit" }
</span><span class='line'>        format.json { render json: @entry.errors, status: :unprocessable_entity }
</span><span class='line'>      end
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # DELETE /entries/1
</span><span class='line'>  # DELETE /entries/1.json
</span><span class='line'>  def destroy
</span><span class='line'>    @entry = current_user.entries.find(params[:id])
</span><span class='line'>    @entry.destroy
</span><span class='line'>
</span><span class='line'>    respond_to do |format|
</span><span class='line'>      format.html { redirect_to entries_url }
</span><span class='line'>      format.json { head :no_content }
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>

<p>执行以下命令启动应用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake db:migrate
</span><span class='line'>rails s</span></code></pre></td></tr></table></div></figure>

<p>以前的版本用的CSS框架是<a href="http://blueprintcss.org/">Blueprint</a>，这次使用比它更方便快捷的<a href="https://github.com/twitter/bootstrap">Bootstrap</a>。Bootstrap建立在Less上，有个<a href="https://github.com/metaskills/less-rails-bootstrap">less-rails-bootstrap</a>，不过在安装libv8时竟然要提示缺少Python，拜托！我用的是Ruby，要我装Python，啥意思啊！还是找个Sass版的Bootstrap吧。</p>

<p>下载<a href="https://github.com/jlong/sass-twitter-bootstrap">sass-twitter-bootstrap</a>：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone https://github.com/jlong/sass-twitter-bootstrap.git</span></code></pre></td></tr></table></div></figure>

<p>将sass-twitter-bootstrap/lib中的文件拷贝到app/assets/stylesheets/twitter目录下。然后将app/assets/stylesheets/application.css中的</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>*= require_tree .</span></code></pre></td></tr></table></div></figure>

<p>修改为</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>*= require twitter/bootstrap</span></code></pre></td></tr></table></div></figure>

<p>再在文件末尾添加：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>body { padding-top: 60px; }</span></code></pre></td></tr></table></div></figure>

<p>现在就可以使用Bootstrap来布局美化应用了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/progress-bar-does-not-work-when-reopen-progressdialog-using-showdialog/">使用showDialog()创建的ProgressDialog再次打开时进度条不变化</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-04-15T13:15:24+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>1:15 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>先来看段代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="utf-8"?&gt;
</span><span class='line'>&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
</span><span class='line'>    android:layout_width="fill_parent"
</span><span class='line'>    android:layout_height="fill_parent"
</span><span class='line'>    android:orientation="vertical"&gt;
</span><span class='line'>    &lt;Button
</span><span class='line'>        android:layout_width="fill_parent"
</span><span class='line'>        android:layout_height="wrap_content"
</span><span class='line'>        android:text="Copy Contacts"
</span><span class='line'>        android:onClick="copyContacts" /&gt;
</span><span class='line'>&lt;/LinearLayout&gt;</span></code></pre></td></tr></table></div></figure>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import android.app.Activity;
</span><span class='line'>import android.app.Dialog;
</span><span class='line'>import android.app.ProgressDialog;
</span><span class='line'>import android.os.AsyncTask;
</span><span class='line'>import android.os.Bundle;
</span><span class='line'>import android.view.View;
</span><span class='line'>
</span><span class='line'>public class DialogActivity extends Activity {
</span><span class='line'>    private static final int COPY_CONTACTS = 0;
</span><span class='line'>
</span><span class='line'>    private ProgressDialog mProgressDialog;
</span><span class='line'>
</span><span class='line'>    @Override
</span><span class='line'>    public void onCreate(Bundle savedInstanceState) {
</span><span class='line'>        super.onCreate(savedInstanceState);
</span><span class='line'>        setContentView(R.layout.main);
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    public void copyContacts(View target) {
</span><span class='line'>        showDialog(COPY_CONTACTS);
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    @Override
</span><span class='line'>    protected Dialog onCreateDialog(int id) {
</span><span class='line'>        switch (id) {
</span><span class='line'>        case COPY_CONTACTS:
</span><span class='line'>            mProgressDialog = new ProgressDialog(this);
</span><span class='line'>            mProgressDialog.setTitle("Copy contacts");
</span><span class='line'>            mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
</span><span class='line'>            mProgressDialog.setMax(100);
</span><span class='line'>            new AsyncCopyContactsTask().execute();
</span><span class='line'>            break;
</span><span class='line'>        }
</span><span class='line'>        return mProgressDialog;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    private class AsyncCopyContactsTask extends AsyncTask&lt;Void, Void, Integer&gt; {
</span><span class='line'>        @Override
</span><span class='line'>        protected Integer doInBackground(Void... params) {
</span><span class='line'>            for (int i = 0; i &lt; 100; i++) {
</span><span class='line'>                try {
</span><span class='line'>                    Thread.sleep(100);
</span><span class='line'>                } catch (InterruptedException e) {
</span><span class='line'>                }
</span><span class='line'>                publishProgress();
</span><span class='line'>            }
</span><span class='line'>            return 0;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        protected void onProgressUpdate(Void... progress) {
</span><span class='line'>            mProgressDialog.incrementProgressBy(1);
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        protected void onPostExecute(Integer result) {
</span><span class='line'>            mProgressDialog.dismiss();
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

<p>第一次点击按钮会显示一个进度条，上面的数字处于变动当中，到达最大值后进度条会消失不见；再次点击按钮后，就会发现进度条上的数值和消失前相同，并且不再变化，而且进度条也不会消失。这是为什么呢？</p>

<p>Activity中有三个和对话框显示有关的方法：showDialog()，dismissDialog()和removeDialog()。其中showDialog()用于显示一个对话框；dismissDialog()使对话框消失，但仍然处于内存中，只是不显示而已，如果再次调用showDialog()方法，则缓存在内存中的对话框会重新显示，而不需要重新创建。removeDialog()使对话框消失，并从内存中将对话框清除，如果再次调用showDialog()来显示它，则在显示之前需要重新创建对话框。</p>

<p>在一个对话框的声明周期内，onCreateDialog()仅被调用一次，但onPrepareDialog()方法会每次被调用。比如，第一次调用 showDialog()方法显示某个对话框时，会先触发onCreateDialog()的执行，然后再触发onPrepareDialog()方法；如果将某个对话框 removeDialog()后再showDialog()，也会先触发onCreateDialog()，接着触发onPrepareDialog()方法；如果某个对话框是被dismiss()掉的，再调用 showDialog()方法来显示它时就不会触发onCreateDialog()方法的执行，只会触发onPrepareDialog()方法。</p>

<p>这是因为第一次调用showDialog()时，Android从你的Activity中调用onCreateDialog()方法，得到返回的Dialog对象。把当前Activity设置为该对话框的所有者，从而把对话框挂靠到Activity上，让Activity自动管理该对话框的状态。这样，下次调用showDialog()时就不用重新创建Dialog对象，而是复用旧的。</p>

<p>所以，解决再次打开ProgressDialog时进度条不变化的最好方法就是将mProgressDialog.dismiss()改成removeDialog(COPY_CONTACTS)。</p>

<p>注意：如果你决定在onCreateDialog()方法之外创建一个对话框，它将不会被附着到活动上。不过，你可以通过setOwnerActivity()把它附着到一个Activity上。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/12">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/10">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/learn-anything-faster-with-the-feynman-technique/">费曼技巧：最好的学习方法</a>
      </li>
    
      <li class="post">
        <a href="/blog/code-coverage-100-percent-tragedy/">100%代码覆盖率的悲剧</a>
      </li>
    
      <li class="post">
        <a href="/blog/unconventional-way-of-learning-a-new-programming-language/">学习新编程语言的非传统方式</a>
      </li>
    
      <li class="post">
        <a href="/blog/the-impact-github-is-having-on-your-software-career-right-now/">GitHub对软件职业生涯的影响</a>
      </li>
    
      <li class="post">
        <a href="/blog/how-to-modify-hosts-in-android/">如何修改Android的hosts文件</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Recent Comments</h1>
  <div class="dsq-widget">
    <script type="text/javascript" src="http://codemany.disqus.com/recent_comments_widget.js"></script>
  </div>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
    <a style="font-size: 143%" href="/tags/antlr/">ANTLR</a>
<a style="font-size: 107%" href="/tags/algorithm/">Algorithm</a>
<a style="font-size: 134%" href="/tags/android/">Android</a>
<a style="font-size: 104%" href="/tags/c-plus-plus/">C++</a>
<a style="font-size: 107%" href="/tags/css/">CSS</a>
<a style="font-size: 109%" href="/tags/crack/">Crack</a>
<a style="font-size: 107%" href="/tags/database/">Database</a>
<a style="font-size: 96%" href="/tags/eclipse/">Eclipse</a>
<a style="font-size: 114%" href="/tags/git/">Git</a>
<a style="font-size: 96%" href="/tags/html/">HTML</a>
<a style="font-size: 104%" href="/tags/jbookshelf/">JBookShelf</a>
<a style="font-size: 148%" href="/tags/java/">Java</a>
<a style="font-size: 100%" href="/tags/javascript/">JavaScript</a>
<a style="font-size: 96%" href="/tags/listview/">ListView</a>
<a style="font-size: 104%" href="/tags/mysql/">MySQL</a>
<a style="font-size: 96%" href="/tags/paperclip/">Paperclip</a>
<a style="font-size: 118%" href="/tags/powerbuilder/">PowerBuilder</a>
<a style="font-size: 100%" href="/tags/powerscript/">PowerScript</a>
<a style="font-size: 116%" href="/tags/qianbao/">Qianbao</a>
<a style="font-size: 150%" href="/tags/rails/">Rails</a>
<a style="font-size: 118%" href="/tags/ruby/">Ruby</a>
<a style="font-size: 96%" href="/tags/spring/">Spring</a>
<a style="font-size: 100%" href="/tags/struts/">Struts</a>
<a style="font-size: 141%" href="/tags/translation/">Translation</a>
<a style="font-size: 96%" href="/tags/ubuntu/">Ubuntu</a>
<a style="font-size: 107%" href="/tags/windows-server-2008/">Windows Server 2008</a>
<a style="font-size: 107%" href="/tags/wxwidgets/">wxWidgets</a>

  </ul>
</section>
<section>
  <h1>Blogroll</h1>
  <ul>
    <li><a href="http://mindhacks.cn/">刘未鹏MIND HACKS</a></li>
    <li><a href="http://www.importnew.com/">ImportNew</a></li>
    <li><a href="http://ifeve.com/">并发编程网</a></li>
    <li><a href="http://codingnow.com/">云风的 BLOG</a></li>
    <li><a href="http://dbanotes.net/">DBA Notes</a></li>
    <li><a href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志</a></li>
    <li><a href="http://advdbg.org/">高端调试</a></li>
    <li><a href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html">Data Structure Visualization</a></li>
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/dohkoos">@dohkoos</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dohkoos',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>
  <div>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</div>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - dohkoos -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'codemany';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
