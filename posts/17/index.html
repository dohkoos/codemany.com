
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>乐者为王</title>
  <meta name="author" content="dohkoos">

  
  <meta name="description" content="两个晚上的时间，一边查资料一边学习，同时编写和测试安装脚本，最终完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序。现在不用配置就可以使用wxWidgets Wizard的代码框架生成功能了。安装制作程序采用的是Inno Setup， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://codemany.com/posts/17/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="乐者为王" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46570161-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">乐者为王</a></h1>
  
    <h2>Do one thing, and do it well.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="codemany.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/complete-wxwidgets-wizard-for-visual-studio-2005-and-2008-install-program/">完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-05-21T15:28:16+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2008</span></span> <span class='time'>3:28 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>两个晚上的时间，一边查资料一边学习，同时编写和测试安装脚本，最终完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序。现在不用配置就可以使用wxWidgets Wizard的代码框架生成功能了。安装制作程序采用的是Inno Setup，完整的安装脚本如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#define SrcImgsDir '..\VCWizards\images'
</span><span class='line'>#define SrcHtmlDir '..\VCWizards\html\1033'
</span><span class='line'>#define SrcScptDir '..\VCWizards\scripts\1033'
</span><span class='line'>#define SrcTempDir '..\VCWizards\templates\1033'
</span><span class='line'>#define TgtImgsDir 'VCWizards\AppWiz\wxWidgets\Application\images'
</span><span class='line'>#define TgtHtmlDir 'VCWizards\AppWiz\wxWidgets\Application\html\1033'
</span><span class='line'>#define TgtScptDir 'VCWizards\AppWiz\wxWidgets\Application\scripts\1033'
</span><span class='line'>#define TgtTempDir 'VCWizards\AppWiz\wxWidgets\Application\templates\1033'
</span><span class='line'>
</span><span class='line'>[Setup]
</span><span class='line'>AppName=wxWidgets Application Wizard
</span><span class='line'>AppVerName=wxWidgets Wizard 1.0.0
</span><span class='line'>AppPublisher=dohkoos
</span><span class='line'>DefaultDirName={pf32}\Microsoft Visual Studio 9.0\VC
</span><span class='line'>DirExistsWarning=no
</span><span class='line'>;Uninstallable=no
</span><span class='line'>UninstallFilesDir={app}\VCWizards\AppWiz\wxWidgets
</span><span class='line'>UninstallDisplayIcon={app}\VCProjects\wxAppWiz.ico
</span><span class='line'>Compression=lzma
</span><span class='line'>SolidCompression=yes
</span><span class='line'>
</span><span class='line'>[Files]
</span><span class='line'>Source: ..\VCProjects\wxAppWiz.ico; DestDir: {app}\VCProjects
</span><span class='line'>Source: ..\VCProjects\wxAppWiz.vsz; DestDir: {app}\VCProjects
</span><span class='line'>Source: ..\VCProjects\wxWidgets\wxWidgets.vsdir; DestDir: {app}\VCProjects\wxWidgets
</span><span class='line'>Source: {#SrcImgsDir}\*.gif; DestDir: {app}\{#TgtImgsDir}
</span><span class='line'>Source: {#SrcHtmlDir}\*.htm; DestDir: {app}\{#TgtHtmlDir}
</span><span class='line'>Source: {#SrcHtmlDir}\*.css; DestDir: {app}\{#TgtHtmlDir}
</span><span class='line'>Source: {#SrcScptDir}\*.js; DestDir: {app}\{#TgtScptDir}
</span><span class='line'>Source: {#SrcTempDir}\*.h; DestDir: {app}\{#TgtTempDir}
</span><span class='line'>Source: {#SrcTempDir}\*.cpp; DestDir: {app}\{#TgtTempDir}
</span><span class='line'>Source: {#SrcTempDir}\readme.txt; DestDir: {app}\{#TgtTempDir}
</span><span class='line'>Source: {#SrcTempDir}\root.manifest; DestDir: {app}\{#TgtTempDir}
</span><span class='line'>Source: {#SrcTempDir}\Templates.inf; DestDir: {app}\{#TgtTempDir}
</span><span class='line'>
</span><span class='line'>[Code]
</span><span class='line'>procedure CurStepChanged(CurStep: TSetupStep);
</span><span class='line'>var
</span><span class='line'>    i: Integer;
</span><span class='line'>    Signature: String;
</span><span class='line'>    ConfigLine: String;
</span><span class='line'>    ConfigFile: String;
</span><span class='line'>    ConfigFileLines: TArrayOfString;
</span><span class='line'>begin
</span><span class='line'>    if CurStep = ssPostInstall then begin
</span><span class='line'>        Signature := 'wxWidgets';
</span><span class='line'>        ConfigLine := 'wxWidgets|{1B027A40-8F43-11D0-8D11-00A0C91BC942}|#1043|70' + #13#10;
</span><span class='line'>        ConfigFile := ExpandConstant('{app}\VCProjects\vc.vsdir');
</span><span class='line'>        LoadStringsFromFile(ConfigFile, ConfigFileLines);
</span><span class='line'>        for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
</span><span class='line'>            if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then abort;
</span><span class='line'>        end;
</span><span class='line'>        SaveStringToFile(ConfigFile, ConfigLine, True);
</span><span class='line'>    end;
</span><span class='line'>end;
</span><span class='line'>
</span><span class='line'>procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);
</span><span class='line'>var
</span><span class='line'>    i: Integer;
</span><span class='line'>    j: Integer;
</span><span class='line'>    Signature: String;
</span><span class='line'>    ConfigFile: String;
</span><span class='line'>    ConfigFileLines, NewConfigFileLines: TArrayOfString;
</span><span class='line'>begin
</span><span class='line'>    if CurUninstallStep = usUninstall then begin
</span><span class='line'>        Signature := 'wxWidgets';
</span><span class='line'>        ConfigFile := ExpandConstant('{app}\VCProjects\vc.vsdir');
</span><span class='line'>        LoadStringsFromFile(ConfigFile, ConfigFileLines);
</span><span class='line'>        SetArrayLength(NewConfigFileLines, GetArrayLength(ConfigFileLines) - 1);
</span><span class='line'>        j := 0;
</span><span class='line'>        for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
</span><span class='line'>            if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then begin
</span><span class='line'>                continue;
</span><span class='line'>            end else begin
</span><span class='line'>                NewConfigFileLines[j] := ConfigFileLines[i];
</span><span class='line'>                j := j + 1;
</span><span class='line'>            end;
</span><span class='line'>        end;
</span><span class='line'>        SaveStringsToFile(ConfigFile, NewConfigFileLines, False);
</span><span class='line'>    end;
</span><span class='line'>end;</span></code></pre></td></tr></table></div></figure>

<p>代码下载：<a href="https://github.com/dohkoos/wxwizard">https://github.com/dohkoos/wxwizard</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/10-tips-for-how-to-name-your-project/">如何命名你的项目的10个技巧</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-05-14T14:45:32+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>2:45 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>英文原文：<a href="http://www.wynia.org/wordpress/2006/06/22/10-tips-for-how-to-name-your-project/">http://www.wynia.org/wordpress/2006/06/22/10-tips-for-how-to-name-your-project/</a></p>

<p>这是我在几年前写的一系列东西中的另一篇，但是我想再分享一下。给那些开始产品和服务的人们，他们需要一些说明以便于理解，发音或正确拼写产品和服务的名字，我想该文章的价值就如同我第一次写它的时候一样。</p>

<p>如何（和避免那样）命名你的项目</p>

<ol>
<li>如果你考虑的名字是直接取自科幻或奇幻作品，不必费心了。这些名字在软件中作为命名源的比例非常大。不仅是你想出有独创性名字的机会相当小，而且大部分作品中的角色和地方的名字都被商标化了，你要冒着被起诉的危险。</li>
<li>如果你考虑的名字来自于希腊，罗马或北欧神话，再试一次。我们已经有了足够多的被称为“Mercury”变体的邮件相关软件。</li>
<li>在Google上搜索被提议的名字。你得到的结果越少越好。如果没有结果，那么就是它。</li>
<li>不要试图通过轻微拼错某事得到一个唯一名字。叫你的新窗口文件系统程序为Phat32只会以用户沮丧的看着“fat32”在搜索引擎中的结果而告终。</li>
<li>如果你的产品名称不能在电视上用50s或60s说完，你或许走在了错误的道路上。这是尤其适用的如果你希望任何人在工作环境使用你的产品。没有人会去推荐一个产品给他们的工友，如果他们会遭到性骚扰起诉只是为了说出产品的名称。</li>
<li>如果你的产品名称根本不能被发音，你就完全得不到口碑的好处。同样，如果没人知道如何去发音它，他们就非常有可能不会试着大声的说着它去询问关于它的问题，等等。你怎么说MySQL? PostgreSQL? GNU? 在地球上的几乎所有口语都是基于某类辅音/元音音节。在辅音和元音之间交替是一个相当好的方式保证别人能够发音它。</li>
<li>越短越好。</li>
<li>查看.com域名是否有效。如果不是，那就证明有人比你先想到了这个名称，并且正在使用它或接近使用它。即使你不打算使用域名也要做这一步。</li>
<li>不要让你产品中固有的局限性成为名称的一部分。把你的产品名称叫做LinProduct或WinProduct预先的就永远阻止你发布任一类的跨平台版本。</li>
<li>不要使用你自己的名字来命名开源产品。如果项目在你不再参与开发后仍然活着，项目要么是重命名，要么就是你的名字可能会被使用在你意想不到的地方。</li>
</ol>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/extend-windows-server-2008-evaluation-period/">延长Windows Server 2008的评估期限</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-05-11T21:56:51+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>9:56 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天，对正在使用的Windows Server 2008做了一次延长评估期限的操作。</p>

<blockquote>
<ol>
<li>Click <strong>Start</strong>, and then click <strong>Command Prompt</strong>.</li>
<li>Type <strong>slmgr.vbs -dli</strong>, and then press ENTER to check the current status of your evaluation period.</li>
<li>To reset the evaluation period, type <strong>slmgr.vbs -rearm</strong>, and then press ENTER.</li>
<li>Restart the computer.</li>
</ol>

<p>This resets the evaluation period to 60 days.</p>
</blockquote>

<p>在做完延长操作后终于明白了网上关于“当您重置当前60天评估期，丢失以前60天评估期上保留任何时间”译文的意思，也即上面“This resets the evaluation period to 60 days”的意思。它是指不管你当前剩余的评估时间是多少，重置之后都会变成60天。例如，我在重置前的评估期还剩有25天，在重置后就变成了60天，并不是加上60天，变成85天。因此，要想最大化总的评估时间，最好到接近评估时间末尾时再重置评估期。</p>

<p>完整的KB可以查看<a href="http://support.microsoft.com/kb/948472">这里</a>。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/using-antlr-to-build-powerscript-grammar-parser-part6/">使用ANTLR构建PowerScript语法分析器（6）</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-05-03T19:07:10+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2008</span></span> <span class='time'>7:07 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>构建完表达式的语法规则后就可以开始分析语句（statement）的语法规则。不过在这之前还需要先修复两个小缺陷：没有识别日期、时间和内建常量的词法规则。</p>

<p>在PowerScript中，日期的格式是0000-00-00，年份是4位数从1000到3000，月份从01到12，天数从01到31；时间是24小时格式00:00:00:000000，秒的小数部分可有可无，最多能有6位数字，所以时间范围是从00:00:00到23:59:59:999999。内建常量则以字母开头，字母数字组合，以“!”符号结束的字符串。</p>

<p>根据这些描述我们可以得到日期、时间和内建常量的词法规则：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DATE_LITERAL    // 1996-09-26
</span><span class='line'>    : '1'..'3' '0'..'9' '0'..'9' '0'..'9' '-' '0'..'1' '0'..'9' '-' '0'..'3' '0'..'9'
</span><span class='line'>      {
</span><span class='line'>          System.out.println("date&gt;" + getText());
</span><span class='line'>      }
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>TIME_LITERAL    // 00:00:00:000000
</span><span class='line'>    : '0'..'2' '0'..'9' ':' '0'..'5' '0'..'9' ':' '0'..'5' '0'..'9'
</span><span class='line'>      ( '.' '0'..'9'
</span><span class='line'>      | '0'..'9' '0'..'9'
</span><span class='line'>      | '0'..'9' '0'..'9' '0'..'9'
</span><span class='line'>      | '0'..'9' '0'..'9' '0'..'9' '0'..'9'
</span><span class='line'>      | '0'..'9' '0'..'9' '0'..'9' '0'..'9' '0'..'9'
</span><span class='line'>      | '0'..'9' '0'..'9' '0'..'9' '0'..'9' '0'..'9' '0'..'9'
</span><span class='line'>      )?
</span><span class='line'>      {
</span><span class='line'>          System.out.println("time&gt;" + getText());
</span><span class='line'>      }
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>ENUM_LITERAL
</span><span class='line'>    : Letter (Letter|'0'..'9')* '!'
</span><span class='line'>      {
</span><span class='line'>          System.out.println("enum&gt;" + getText());
</span><span class='line'>      }
</span><span class='line'>    ;</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/using-antlr-to-build-powerscript-grammar-parser-part5/">使用ANTLR构建PowerScript语法分析器（5）</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-05-02T19:27:12+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2008</span></span> <span class='time'>7:27 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>基本表达式的语法规则构建完毕，那么表达式的语法规则构建就颇为简单了。<a href="http://localhost:4000/blog/using-antlr-to-build-powerscript-grammar-parser-part4/">使用ANTLR构建PowerScript语法分析器（4）</a>中已经说过表达式是由运算元和运算符复合组成。所以在编写表达式语法规则前先要分析下PowerScript的运算符以及它们的优先级。</p>

<p>PowerScript支持四种类型的运算符，分别是：</p>

<ul>
<li>针对数字数据类型的算术运算符，执行算术计算；</li>
<li>针对所有类型的关系运算符，比较数字，文本和布尔值；</li>
<li>针对布尔类型的逻辑运算符，执行布尔值上的关系运算符</li>
<li>针对字符串类型连接运算符，连接字符串和二进制大对象。</li>
</ul>

<h3 id="算术运算符">算术运算符</h3>

<table><thead>
<tr>
<th>Operator</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>+</td>
<td>Addition</td>
</tr>
<tr>
<td>-</td>
<td>Subtraction</td>
</tr>
<tr>
<td>*</td>
<td>Multiplication</td>
</tr>
<tr>
<td>/</td>
<td>Division</td>
</tr>
<tr>
<td>^</td>
<td>Exponentiation</td>
</tr>
</tbody></table>

<h3 id="关系运算符">关系运算符</h3>

<table><thead>
<tr>
<th>Operator</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>=</td>
<td>Equals</td>
</tr>
<tr>
<td>&gt;</td>
<td>Greater than</td>
</tr>
<tr>
<td>&lt;</td>
<td>Less than</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>Not equal</td>
</tr>
<tr>
<td>&gt;=</td>
<td>Greater than or equal</td>
</tr>
<tr>
<td>&lt;=</td>
<td>Less than or equal</td>
</tr>
</tbody></table>

<h3 id="逻辑运算符">逻辑运算符</h3>

<table><thead>
<tr>
<th>Operator</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>NOT</td>
<td>Logical negation</td>
</tr>
<tr>
<td>AND</td>
<td>Logical and</td>
</tr>
<tr>
<td>OR</td>
<td>Logical or</td>
</tr>
</tbody></table>

<h3 id="连接运算符">连接运算符</h3>

<table><thead>
<tr>
<th>Operator</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>+</td>
<td>Concatenate</td>
</tr>
</tbody></table>

<h3 id="运算符优先级">运算符优先级</h3>

<table><thead>
<tr>
<th>Operator</th>
<th>Purpose</th>
</tr>
</thead><tbody>
<tr>
<td>( )</td>
<td>Grouping (see note below on overriding)</td>
</tr>
<tr>
<td>+, -</td>
<td>Unary plus and unary minus (indicates positive or negative number)</td>
</tr>
<tr>
<td>^</td>
<td>Exponentiation</td>
</tr>
<tr>
<td>*, /</td>
<td>Multiplication and division</td>
</tr>
<tr>
<td>+, -</td>
<td>Addition and subtraction; string concatenation</td>
</tr>
<tr>
<td>=, &gt;, &lt;, &lt;=, &gt;=, &lt;&gt;</td>
<td>Relational operators</td>
</tr>
<tr>
<td>NOT</td>
<td>Negation</td>
</tr>
<tr>
<td>AND</td>
<td>Logical and</td>
</tr>
<tr>
<td>OR</td>
<td>Logical or</td>
</tr>
</tbody></table>

<p>清楚运算符和优先级后，该如何表示这些表达式的语法关系呢？有个标准的分析表达式的递归定义可以套用，大部分表达式都遵循这个模式：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>thisLevelExpression
</span><span class='line'>    : nextHigherPrecedenceExpression (OPERATOR nextHigherPrecedenceExpression)*</span></code></pre></td></tr></table></div></figure>

<p>现在我们就可以根据PowerScript的运算符优先级写出表达式的语法规则了：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>expression
</span><span class='line'>    : logical_or_expression
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>logical_or_expression
</span><span class='line'>    : logical_and_expression ('or' logical_and_expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>logical_and_expression
</span><span class='line'>    : logical_not_expression ('and' logical_not_expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>logical_not_expression
</span><span class='line'>    : 'not'? relational_expression
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>relational_expression
</span><span class='line'>    : additive_expression (('='|'&gt;'|'&lt;'|'&lt;&gt;'|'&gt;='|'&lt;=') additive_expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>additive_expression
</span><span class='line'>    : multiplicative_expression (('+'|'-') multiplicative_expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>multiplicative_expression
</span><span class='line'>    : exponentive_expression (('*'|'/') exponentive_expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>exponentive_expression
</span><span class='line'>    : unary_expression ('^' unary_expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>unary_expression
</span><span class='line'>    : ('+'|'-')? primary_expression
</span><span class='line'>    ;</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/using-antlr-to-build-powerscript-grammar-parser-part4/">使用ANTLR构建PowerScript语法分析器（4）</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-04-26T22:17:05+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>10:17 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>到目前为止，PowerScript的词法分析已经完成的差不多了，接下来就要开始实现它的语法规则。我们准备先从表达式（expression）开始下手，因为它是语法规则中最核心的部分。</p>

<p>简单的来说，表达式是计算的最小单元，是可以被计算产生值的代码的任何部分。一般是由一个或多个运算元和通常是一个运算符构成，运算元本身也可以是表达式。这样层层递归嵌套，直到被称为基本表达式（primary expression）的最简单部分。</p>

<p>基本表达式包含有标志符、字面量（literal）、字段存取、函数调用和数组存取等，圆括号括起的表达式通常也被认为是基本表达式。以下是它们的大致表现形式：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rating
</span><span class='line'>'This is a string'
</span><span class='line'>x.y
</span><span class='line'>f(x)
</span><span class='line'>a[x]
</span><span class='line'>(x)</span></code></pre></td></tr></table></div></figure>

<p>在PowerScript中调用函数和事件的语法如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{ objectname. } { ancestorname :: } { type } { calltype } { when } name ( { argumentlist } )</span></code></pre></td></tr></table></div></figure>

<p>其中，花括号中的项表示可以有可以无。type有两个值function和event，calltype有两个值static和dynamic，when有两个值trigger和post，并且type，calltype和when的顺序可以任意调换。如果ancestorclass是当前对象的直接父类的话，那么可以使用super关键字代替。</p>

<p>这里是收集的一些基本表达式：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>this.ls_array[1]
</span><span class='line'>this.event pfc_addrow()
</span><span class='line'>this.event rowfocuschanged(ll_row)
</span><span class='line'>this.event post doubleclicked(xpos, ypos, row, dwo)
</span><span class='line'>this.uo_1.function hallo()
</span><span class='line'>post function column_order_update_from_grid()
</span><span class='line'>event ue_process()
</span><span class='line'>
</span><span class='line'>close(parent)
</span><span class='line'>parent.enabled
</span><span class='line'>parent.hide()
</span><span class='line'>parent.event ue_postconstructor()
</span><span class='line'>parent.function static trigger wf_process( )
</span><span class='line'>parent.post uf_process_item ()
</span><span class='line'>
</span><span class='line'>super::create
</span><span class='line'>super::event clicked()
</span><span class='line'>super::event clicked(xpos, ypos, row, dwo)
</span><span class='line'>super::of_remove_tail(anv_tailnode)
</span><span class='line'>super::event trigger selectionchanging(oldindex, newindex)
</span><span class='line'>
</span><span class='line'>iu_tab_postings.post of_enable_sort(dw_main, dw_detail, false)
</span><span class='line'>lw_sheet.dynamic event pfc_close()
</span><span class='line'>w_main.event doubleclicked(flags, xpos, ypos)
</span><span class='line'>dw_main.event pfc_retrieve()
</span><span class='line'>cb_ok.event trigger clicked()
</span><span class='line'>cb_ok.triggerevent(clicked!)</span></code></pre></td></tr></table></div></figure>

<p>有了以上的这些信息，我们就可以很容易地得到基本表达式的语法规则：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>expression_list
</span><span class='line'>    : expression (',' expression)*
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>expression
</span><span class='line'>    : primary_expression
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>primary_expression
</span><span class='line'>    : '(' expression ')'
</span><span class='line'>    | (object_name '.')* (ancestor_name '::')? call_specifier* IDENTIFIER identifier_suffix?
</span><span class='line'>    | literal
</span><span class='line'>    | '::'? object_name
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>object_name
</span><span class='line'>    : 'this'
</span><span class='line'>    | 'parent'
</span><span class='line'>    | IDENTIFIER
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>ancestor_name
</span><span class='line'>    : 'super'
</span><span class='line'>    | IDENTIFIER
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>call_specifier
</span><span class='line'>    : 'function'
</span><span class='line'>    | 'event'
</span><span class='line'>    | 'static'
</span><span class='line'>    | 'dynamic'
</span><span class='line'>    | 'trigger'
</span><span class='line'>    | 'post'
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>identifier_suffix
</span><span class='line'>    : arguments ('.' IDENTIFIER arguments)*    // cascaded calling
</span><span class='line'>    | '[' expression_list? ']'
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>arguments
</span><span class='line'>    : '(' expression_list? ')'
</span><span class='line'>    ;
</span><span class='line'>
</span><span class='line'>literal
</span><span class='line'>    : STRING_LITERAL
</span><span class='line'>    | INTEGER_LITERAL
</span><span class='line'>    | FLOAT_LITERAL
</span><span class='line'>    | BOOLEAN_LITERAL
</span><span class='line'>    | LINE_COMMENT
</span><span class='line'>    | BLOCK_COMMENT
</span><span class='line'>    ;</span></code></pre></td></tr></table></div></figure>

<p>不过，如果到这里就开始用ANTLR工具生成词法分析器和语法分析器的话，你会得到一堆的警告信息。要消除这些警告需要在语法文件头部添加：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>options {
</span><span class='line'>    backtrack=true;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

<p>它的作用是告诉ANTLR在LL(*)语法分析失败的时候要去尝试匹配其它选项。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/cannot-launch-the-remote-parser-because-port-49153-is-already-in-use/">Cannot launch the remote parser because port 49153 is already in use</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-04-25T16:03:53+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>4:03 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在Windows Server 2008使用ANTLRWorks调试语法文件时，总是提示说什么端口49153已被占用。使用netstat -an发现这个端口正在被别的进程监听着，虽然知道问题原因，但是不知道如何解决。后来从<a href="http://www.cnblogs.com/zhoujg/archive/2008/03/29/1129281.html">如果AntlrWorks的Debug报错“当前端口已被占用”，可能是防火墙的原因</a>得到启示：AntlrWorks是可以修改远程调试端口的。不过我没有像该文作者介绍的那样将调试端口改成49253，因为那样可能需要设置防火墙。而是直接将之设置到了一个不在使用的端口49151上。</p>

<p>设置调试端口的路径如下：</p>

<p>File -&gt; Preferences -&gt; Debugger -&gt; Default local port</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/install-radiant-on-lunarpages-shared-server/">在Lunarpages虚拟主机上安装Radiant</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-04-20T06:55:11+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>6:55 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>安裝Rails、Mongrel和Radiant</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem install rails --include-dependencies
</span><span class='line'>gem install mongrel --include-dependencies
</span><span class='line'>gem install radiant --include-dependencies</span></code></pre></td></tr></table></div></figure>

<p>建立Radiant项目</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>radiant --database mysql rcms</span></code></pre></td></tr></table></div></figure>

<p>登录Lunarpages cPanel面板，创建数据库rcms及访问该数据库的账号，设置该帐号的访问权限。然后进入MySQL的数据库管理工具phpMyAdmin，导入在本地建立好的创建数据表的SQL文件，执行之。然后修改config/database.yml文件，填入前面创建的访问数据库的用户名和密码。</p>

<p>将config/environment.rb中的</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#ENV['RAILS_ENV'] ||= 'production'</span></code></pre></td></tr></table></div></figure>

<p>去掉注释</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ENV['RAILS_ENV'] ||= 'production'</span></code></pre></td></tr></table></div></figure>

<p>再将public/dispatch.fcgi中的</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/env ruby</span></code></pre></td></tr></table></div></figure>

<p>修改为</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/local/bin/ruby</span></code></pre></td></tr></table></div></figure>

<p>然后将rcms上传到Lunarpages虚拟主机的根目录下，上传后的目录结构如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/public_html
</span><span class='line'>/www
</span><span class='line'>/rcms</span></code></pre></td></tr></table></div></figure>

<p>在cPanel中点击“Cron Jobs” -&gt; “Advanced (Unix Style)”进入Cron管理页面。</p>

<p><img src="/uploads/lunarpages-cron-jobs.png" title="lunarpages-cron-jobs" ></p>

<p>创建如下Cron指令（使用默认时间设置，指令会每分钟被执行一次）。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /home/&lt;username&gt;
</span><span class='line'>mv public_html public_html.bak
</span><span class='line'>ln -s /home/&lt;username&gt;/rcms/public public_html
</span><span class='line'>mkdir public_html/cgi-bin
</span><span class='line'>chown -R username:&lt;username&gt; /home/&lt;username&gt;/rcms
</span><span class='line'>chmod 755 /home/&lt;username&gt;/rcms
</span><span class='line'>chmod 755 /home/&lt;username&gt;/rcms/public</span></code></pre></td></tr></table></div></figure>

<p>再填好接收执行结果的邮件地址，然后等个2-3分钟后查收邮件就可以了，在收到邮件后切记要删除上面创建的指令。</p>

<p>现在就可以通过浏览器访问部署在Lunarpages上的Radiant了。</p>

<p>如果你想让Radiant跑在类似<code>http://example.com/rcms</code>这样的域名下，那么可以将上面的指令替换成：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /home/&lt;username&gt;/public_html
</span><span class='line'>ln -s ../rcms/public rcms
</span><span class='line'>chown -R username:&lt;username&gt; /home/&lt;username&gt;/rcms
</span><span class='line'>chmod 755 /home/&lt;username&gt;/rcms</span></code></pre></td></tr></table></div></figure>

<p>如果Radiant不工作的话可以在Cron Jobs中使用下列指令检查出了什么问题。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /home/&lt;username&gt;/rcms/public
</span><span class='line'>chmod 777 dispatch.fcgi
</span><span class='line'>./dispatch.fcgi
</span><span class='line'>chmod 644 dispatch.fcgi</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/running-mongrel-and-radiant-on-windows/">在Windows上面跑Mongrel + Radiant</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-04-16T16:16:41+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>4:16 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>安裝Rails、Mongrel和Radiant</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem install rails --include-dependencies
</span><span class='line'>gem install mongrel --include-dependencies
</span><span class='line'>gem install radiant --include-dependencies</span></code></pre></td></tr></table></div></figure>

<p>建立Radiant项目</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>radiant --database mysql rcms</span></code></pre></td></tr></table></div></figure>

<p>编辑数据库配置文件config/database.yml，填写连接数据库时的用户名和密码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>development:
</span><span class='line'>  adapter: mysql
</span><span class='line'>  database: rcms_development
</span><span class='line'>  username: root
</span><span class='line'>  password: 123456
</span><span class='line'>  host: localhost
</span><span class='line'>
</span><span class='line'>test:
</span><span class='line'>  adapter: mysql
</span><span class='line'>  database: rcms_test
</span><span class='line'>  username: root
</span><span class='line'>  password: 123456
</span><span class='line'>  host: localhost
</span><span class='line'>
</span><span class='line'>production:
</span><span class='line'>  adapter: mysql
</span><span class='line'>  database: rcms_production
</span><span class='line'>  username: root
</span><span class='line'>  password: 123456
</span><span class='line'>  host: localhost</span></code></pre></td></tr></table></div></figure>

<p>在MySQL中创建数据库，因为是开发环境，所以创建的数据库名为rcms_development。</p>

<p>进入rcms目录，在命令行下敲入以下命令创建数据表：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake development db:bootstrap</span></code></pre></td></tr></table></div></figure>

<p>一切都准备好后，就可以启动Mongrel服务器了：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongrel_rails start</span></code></pre></td></tr></table></div></figure>

<p>不出意料的话，应该会看到如下图的信息。</p>

<p><img src="/uploads/mongrel-rails.png" title="mongrel-rails" ></p>

<p>如果在启动Mongrel时遇到下面的错误：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>!!! Path to log file not valid: log/mongrel.log
</span><span class='line'>mongrel::start reported an error. Use mongrel_rails mongrel::start -h to get help.</span></code></pre></td></tr></table></div></figure>

<p>可以通过指定应用目录来解决，因为Mongrel在创建log之前会先验证应用目录。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongrel_rails start -c rcms</span></code></pre></td></tr></table></div></figure>

<p>如果想把Mongrel作为Windows服务的形式启动，需要安装mongrel_service插件：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem install mongrel_service</span></code></pre></td></tr></table></div></figure>

<p>注意：某些文档会叫你用gem install win32-service安装win32-service，但实际上不是很必要。因为在安装mongrel_service时系统会问你是否要安装win32-service。</p>

<p>安装好后就可以创建Windows服务了：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongrel_rails service::install -N rcms -c rcms -e development</span></code></pre></td></tr></table></div></figure>

<p>其中-N指明service名称，-c指明Rails应用的目录，-e指启动模式。</p>

<p>在“控制面版” -&gt; “管理工具” -&gt; “服务”中可以发现多了名为rcms的服务。如果要取消该服务，可以使用以下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongrel_rails service::remove -N rcms</span></code></pre></td></tr></table></div></figure>

<p>启动和关闭该服务的命令是：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongrel_rails service::start -N rcms
</span><span class='line'>mongrel_rails service::stop -N rcms</span></code></pre></td></tr></table></div></figure>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/backup-foxmail-mail-using-win32/">使用Win32备份Foxmail的邮件</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2008-04-13T07:38:52+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2008</span></span> <span class='time'>7:38 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Foxmail是一个非常不错的邮件客户端，可惜在对邮箱内邮件的备份上做的不是很好，只能手工一封一封地将邮件导出，在邮件比较少时这样处理还可以应付，但假如有成百上千封邮件时还要这样处理显然是相当郁闷的。因此写了一个可以自动将某个邮箱中所有邮件导出为独立的eml格式邮件文件（该格式可以被OutLook邮件程序识别并打开）的小程序。</p>

<p>在Foxmail的安装目录下有一个mail文件夹，该文件夹中的每个子目录分别对应着一个邮件账号。进入某个帐号对应的文件夹，可以发现文件夹中有以in.BOX、out.BOX、send.BOX、spam.BOX和trash.BOX等文件，它们分别对应于收件箱、发件箱、已发送邮件箱、垃圾邮件箱和废件箱。根据<a href="http://www.yesky.com/72/1663572.shtml">VC++实现Foxmail邮件的批量导出</a>一文可以知道每个邮件头以下面的16个字符开始：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0x10 0x10 0x10 0x10 0x10 0x10 0x10
</span><span class='line'>0x11 0x11 0x11 0x11 0x11 0x11
</span><span class='line'>0x53 0x0D 0x0A</span></code></pre></td></tr></table></div></figure>

<p>知道了邮箱所对应存储文件的格式后，以下的事情就变的简单了。</p>

<ol>
<li>获取要备份的文件夹路径；</li>
<li>遍历该文件夹，找出以BOX为后缀名的邮箱存储文件；</li>
<li>分析存储文件，将邮件导出为eml格式的邮件文本。</li>
</ol>

<p>下面是需要用到的一些Win32 API函数：</p>

<p>创建非模态对话框</p>

<ul>
<li>CreateDialog</li>
</ul>

<p>获取目录信息</p>

<ul>
<li>BROWSEINFO</li>
<li>LPITEMIDLIST</li>
<li>SHBrowseForFolder</li>
<li>SHGetPathFromIDList</li>
</ul>

<p>遍历某个目录下的文件</p>

<ul>
<li>SetCurrentDirectory</li>
<li>FindFileFirst</li>
<li>FindNextFile</li>
<li>FindClose</li>
</ul>

<p>备份邮件</p>

<ul>
<li>CreateDirectory</li>
<li>CreateFile</li>
<li>ReadFile</li>
<li>WriteFile</li>
<li>CloseHandle</li>
</ul>

<p>还有，如果在对话框模版里用到了不一般的控件(比如说进度条)，那么还需要</p>

<ol>
<li>引用头文件commctrl.h；</li>
<li>并链接comctl32.lib；</li>
<li>在WinMain中创建对话框前调用InitCommonControls()方法。</li>
</ol>

<p><a href="/uploads/box2eml.zip" title="box2eml.zip">代码下载</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/18">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/16">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/overnight-success-it-takes-years/">一夜成名：这需要好几年时间</a>
      </li>
    
      <li class="post">
        <a href="/blog/reading-notes-the-definitive-antlr4-reference-part5/">ANTLR 4权威参考读书笔记（5）</a>
      </li>
    
      <li class="post">
        <a href="/blog/reading-notes-the-definitive-antlr4-reference-part4/">ANTLR 4权威参考读书笔记（4）</a>
      </li>
    
      <li class="post">
        <a href="/blog/java-revisited-basics/">Java Revisited：语言基础</a>
      </li>
    
      <li class="post">
        <a href="/blog/reading-notes-the-definitive-antlr4-reference-part3/">ANTLR 4权威参考读书笔记（3）</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Recent Comments</h1>
  <div class="dsq-widget">
    <script type="text/javascript" src="http://codemany.disqus.com/recent_comments_widget.js"></script>
  </div>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
    <a style="font-size: 116%" href="/tags/antlr/">ANTLR</a>
<a style="font-size: 105%" href="/tags/algorithm/">Algorithm</a>
<a style="font-size: 133%" href="/tags/android/">Android</a>
<a style="font-size: 93%" href="/tags/ant/">Ant</a>
<a style="font-size: 111%" href="/tags/crack/">Crack</a>
<a style="font-size: 105%" href="/tags/database/">Database</a>
<a style="font-size: 97%" href="/tags/eclipse/">Eclipse</a>
<a style="font-size: 105%" href="/tags/git/">Git</a>
<a style="font-size: 105%" href="/tags/jbookshelf/">JBookShelf</a>
<a style="font-size: 142%" href="/tags/java/">Java</a>
<a style="font-size: 93%" href="/tags/javascript/">JavaScript</a>
<a style="font-size: 97%" href="/tags/listview/">ListView</a>
<a style="font-size: 105%" href="/tags/mysql/">MySQL</a>
<a style="font-size: 93%" href="/tags/other/">Other</a>
<a style="font-size: 97%" href="/tags/paperclip/">Paperclip</a>
<a style="font-size: 120%" href="/tags/powerbuilder/">PowerBuilder</a>
<a style="font-size: 101%" href="/tags/powerscript/">PowerScript</a>
<a style="font-size: 118%" href="/tags/qianbao/">Qianbao</a>
<a style="font-size: 150%" href="/tags/rails/">Rails</a>
<a style="font-size: 111%" href="/tags/ruby/">Ruby</a>
<a style="font-size: 93%" href="/tags/spring/">Spring</a>
<a style="font-size: 101%" href="/tags/struts/">Struts</a>
<a style="font-size: 113%" href="/tags/translation/">Translation</a>
<a style="font-size: 97%" href="/tags/ubuntu/">Ubuntu</a>
<a style="font-size: 87%" href="/tags/w32dasm/">W32Dasm</a>
<a style="font-size: 108%" href="/tags/windows-server-2008/">Windows Server 2008</a>
<a style="font-size: 108%" href="/tags/wxwidgets/">wxWidgets</a>

  </ul>
</section>
<section>
  <h1>Blogroll</h1>
  <ul>
    <li><a href="http://mindhacks.cn/">刘未鹏MIND HACKS</a></li>
    <li><a href="http://www.importnew.com/">ImportNew</a></li>
    <li><a href="http://ifeve.com/">并发编程网</a></li>
    <li><a href="http://codingnow.com/">云风的 BLOG</a></li>
    <li><a href="http://dbanotes.net/">DBA Notes</a></li>
    <li><a href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志</a></li>
    <li><a href="http://advdbg.org/">高端调试</a></li>
    <li><a href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html">Data Structure Visualization</a></li>
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/dohkoos">@dohkoos</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dohkoos',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - dohkoos -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'codemany';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
