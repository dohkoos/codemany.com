
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>乐者为王</title>
  <meta name="author" content="dohkoos">

  
  <meta name="description" content="Rails已经到3.2版本了，和以前2.3版本有了很大的不同，决定把原来老版本的记账应用重新写一遍。 我们先来定义一下什么是最简单的记账应用：
1. 可以输入花钱的记录
2. 可以修改输入了的记录
3. 可以删除输入了的记录
4. 可以显示所有的记录 下面我们就开始动手吧！ 1
2
3
4 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://codemany.com/posts/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="乐者为王" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <!--script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script-->
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"-->
<!--link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"-->

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">乐者为王</a></h1>
  
    <h2>Do one thing, and do it well.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:codemany.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/18/to-create-a-simple-accounting-application-a-using-rails-32/">用Rails 3.2打造简单记账应用</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-18T07:49:27+08:00" pubdate data-updated="true">Apr 18<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Rails已经到3.2版本了，和以前2.3版本有了很大的不同，决定把原来老版本的记账应用重新写一遍。</p>

<p>我们先来定义一下什么是最简单的记账应用：<br />
1. 可以输入花钱的记录<br />
2. 可以修改输入了的记录<br />
3. 可以删除输入了的记录<br />
4. 可以显示所有的记录</p>

<p>下面我们就开始动手吧！<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rails new qianbao&lt;br /&gt;
</span><span class='line'>cd qianbao&lt;br /&gt;
</span><span class='line'>rails g scaffold entry amount:decimal tags:string effective_date:date&lt;br /&gt;
</span><span class='line'>rails g controller home index&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>删除public/index.html，在config/routes.rb中添加根路由：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root :to =&gt; 'home#index'&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>现在要给应用加上一个认证系统（注册、激活、登录、登出），通过devise（<a href="https://github.com/plataformatec/devise%EF%BC%89%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%E3%80%82">https://github.com/plataformatec/devise%EF%BC%89%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%E3%80%82</a></p>

<p>在Gemfile中添加：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem 'devise'&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>然后执行下列命令：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bundle install&lt;br /&gt;
</span><span class='line'>rails g devise:install&lt;br /&gt;
</span><span class='line'>rails g devise user&lt;br /&gt;
</span><span class='line'>rails g devise:views&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>创建一个migration，把user和entry关联起来：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class AddUserToEntry &lt; ActiveRecord::Migration&lt;br /&gt;
</span><span class='line'>  def change&lt;br /&gt;
</span><span class='line'>    add_column :entries, :user_id, :integer
</span><span class='line'>
</span><span class='line'>    add_index :entries, :user_id&lt;br /&gt;
</span><span class='line'>  end&lt;br /&gt;
</span><span class='line'>end&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>修改Entry和User模型：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Entry &lt; ActiveRecord::Base&lt;br /&gt;
</span><span class='line'>  ...&lt;br /&gt;
</span><span class='line'>  validates :effective_date, :presence =&gt; true&lt;br /&gt;
</span><span class='line'>  validates :amount,         :presence =&gt; true,&lt;br /&gt;
</span><span class='line'>                             :numericality =&gt; {:greater_than =&gt; 0.0},&lt;br /&gt;
</span><span class='line'>                             :format =&gt; {:with =&gt; /^\d+??(?:\.\d{0,2})?$/}&lt;br /&gt;
</span><span class='line'>  validates :tags,           :presence =&gt; true,&lt;br /&gt;
</span><span class='line'>                             :length =&gt; { :within =&gt; 1..255 }&lt;br /&gt;
</span><span class='line'>                             &lt;br /&gt;
</span><span class='line'>  belongs_to :user&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class User &lt; ActiveRecord::Base&lt;br /&gt;
</span><span class='line'>  ...&lt;br /&gt;
</span><span class='line'>  has_many :users&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>修改app/views/home/index.html.erb为如下内容：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;h1&gt;Welcom to Qianbao!&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;% if user_signed_in? %&gt;&lt;br /&gt;
</span><span class='line'>  &lt;p&gt;&lt;br /&gt;
</span><span class='line'>    &lt;strong&gt;&lt;%=link_to current_user.email, edit_user_registration_path %&gt;&lt;/strong&gt;&lt;br /&gt;
</span><span class='line'>    &lt;%= link_to 'Logout', destroy_user_session_path, :method =&gt; :delete %&gt;&lt;br /&gt;
</span><span class='line'>  &lt;/p&gt;&lt;br /&gt;
</span><span class='line'>  &lt;%= link_to "All Entries", entries_path %&gt;&lt;br /&gt;
</span><span class='line'>&lt;% else %&gt;&lt;br /&gt;
</span><span class='line'>  &lt;p&gt;&lt;br /&gt;
</span><span class='line'>    &lt;strong&gt;You are currently not logged in.&lt;/strong&gt;&lt;br /&gt;
</span><span class='line'>    &lt;%= link_to 'Login', new_user_session_path %&gt; or&lt;br /&gt;
</span><span class='line'>    &lt;%= link_to 'Sign up', new_user_registration_path %&gt;&lt;br /&gt;
</span><span class='line'>  &lt;/p&gt;&lt;br /&gt;
</span><span class='line'>&lt;% end %&gt;&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>修改app/controller/entries_controller.rb：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class EntriesController &lt; ApplicationController&lt;br /&gt;
</span><span class='line'>  before_filter :authenticate_user!
</span><span class='line'>
</span><span class='line'>  # GET /entries&lt;br /&gt;
</span><span class='line'>  # GET /entries.json&lt;br /&gt;
</span><span class='line'>  def index&lt;br /&gt;
</span><span class='line'>    @entries = current_user.entries
</span><span class='line'>
</span><span class='line'>    respond_to do |format|&lt;br /&gt;
</span><span class='line'>      format.html # index.html.erb&lt;br /&gt;
</span><span class='line'>      format.json { render json: @entries }&lt;br /&gt;
</span><span class='line'>    end&lt;br /&gt;
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # GET /entries/1&lt;br /&gt;
</span><span class='line'>  # GET /entries/1.json&lt;br /&gt;
</span><span class='line'>  def show&lt;br /&gt;
</span><span class='line'>    @entry = current_user.entries.find(params[:id])
</span><span class='line'>
</span><span class='line'>    respond_to do |format|&lt;br /&gt;
</span><span class='line'>      format.html # show.html.erb&lt;br /&gt;
</span><span class='line'>      format.json { render json: @entry }&lt;br /&gt;
</span><span class='line'>    end&lt;br /&gt;
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # GET /entries/new&lt;br /&gt;
</span><span class='line'>  # GET /entries/new.json&lt;br /&gt;
</span><span class='line'>  def new&lt;br /&gt;
</span><span class='line'>    @entry = current_user.entries.new
</span><span class='line'>
</span><span class='line'>    respond_to do |format|&lt;br /&gt;
</span><span class='line'>      format.html # new.html.erb&lt;br /&gt;
</span><span class='line'>      format.json { render json: @entry }&lt;br /&gt;
</span><span class='line'>    end&lt;br /&gt;
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # GET /entries/1/edit&lt;br /&gt;
</span><span class='line'>  def edit&lt;br /&gt;
</span><span class='line'>    @entry = current_user.entries.find(params[:id])&lt;br /&gt;
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # POST /entries&lt;br /&gt;
</span><span class='line'>  # POST /entries.json&lt;br /&gt;
</span><span class='line'>  def create&lt;br /&gt;
</span><span class='line'>    @entry = current_user.entries.new(params[:entry])&lt;br /&gt;
</span><span class='line'>    @entry.user = current_user
</span><span class='line'>
</span><span class='line'>    respond_to do |format|&lt;br /&gt;
</span><span class='line'>      if @entry.save&lt;br /&gt;
</span><span class='line'>        format.html { redirect_to @entry, notice: 'Entry was successfully created.' }&lt;br /&gt;
</span><span class='line'>        format.json { render json: @entry, status: :created, location: @entry }&lt;br /&gt;
</span><span class='line'>      else&lt;br /&gt;
</span><span class='line'>        format.html { render action: "new" }&lt;br /&gt;
</span><span class='line'>        format.json { render json: @entry.errors, status: :unprocessable_entity }&lt;br /&gt;
</span><span class='line'>      end&lt;br /&gt;
</span><span class='line'>    end&lt;br /&gt;
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # PUT /entries/1&lt;br /&gt;
</span><span class='line'>  # PUT /entries/1.json&lt;br /&gt;
</span><span class='line'>  def update&lt;br /&gt;
</span><span class='line'>    @entry = current_user.entries.find(params[:id])
</span><span class='line'>
</span><span class='line'>    respond_to do |format|&lt;br /&gt;
</span><span class='line'>      if @entry.update_attributes(params[:entry])&lt;br /&gt;
</span><span class='line'>        format.html { redirect_to @entry, notice: 'Entry was successfully updated.' }&lt;br /&gt;
</span><span class='line'>        format.json { head :no_content }&lt;br /&gt;
</span><span class='line'>      else&lt;br /&gt;
</span><span class='line'>        format.html { render action: "edit" }&lt;br /&gt;
</span><span class='line'>        format.json { render json: @entry.errors, status: :unprocessable_entity }&lt;br /&gt;
</span><span class='line'>      end&lt;br /&gt;
</span><span class='line'>    end&lt;br /&gt;
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # DELETE /entries/1&lt;br /&gt;
</span><span class='line'>  # DELETE /entries/1.json&lt;br /&gt;
</span><span class='line'>  def destroy&lt;br /&gt;
</span><span class='line'>    @entry = current_user.entries.find(params[:id])&lt;br /&gt;
</span><span class='line'>    @entry.destroy
</span><span class='line'>
</span><span class='line'>    respond_to do |format|&lt;br /&gt;
</span><span class='line'>      format.html { redirect_to entries_url }&lt;br /&gt;
</span><span class='line'>      format.json { head :no_content }&lt;br /&gt;
</span><span class='line'>    end&lt;br /&gt;
</span><span class='line'>  end&lt;br /&gt;
</span><span class='line'>end&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>执行以下命令启动应用：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake db:migrate&lt;br /&gt;
</span><span class='line'>rails s&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>以前的版本用的css框架是<a href="http://blueprintcss.org/">Blueprint</a>，这次使用比它更方便快捷的<a href="https://github.com/twitter/bootstrap">Bootstrap</a>。Bootstrap建立在less上，有个<a href="https://github.com/metaskills/less-rails-bootstrap">less-rails-bootstrap</a>，不过在安装libv8时竟然要提示缺少Python，拜托！我用的是Ruby，要我装Python，啥意思啊！还是找个sass版的Bootstrap吧。</p>

<p>下载<a href="https://github.com/jlong/sass-twitter-bootstrap">sass-twitter-bootstrap</a>：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone https://github.com/jlong/sass-twitter-bootstrap.git&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>将sass-twitter-bootstrap/lib中的文件拷贝到app/assets/stylesheets/twitter目录下。然后将app/assets/stylesheets/application.css中的<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>*= require_tree .&lt;br /&gt;
</span><span class='line'>[/code]&lt;br /&gt;
</span><span class='line'>修改成&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>*= require twitter/bootstrap<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>再在文件末尾添加：&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>body { padding-top: 60px; }<br />
&#8220;`</p>

<p>现在就可以使用Bootstrap来布局美化应用了。</p>

<p><a href="https://github.com/dohkoos/qianbao">代码下载</a>
</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/15/the-using-showdialog-to-create-progressdialog-open-again-the-progress-bar-does-not-change-the-problem-resolution/">使用showDialog()创建的ProgressDialog再次打开时进度条不变化的问题解析</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-15T13:15:24+08:00" pubdate data-updated="true">Apr 15<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>先来看段代码：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="utf-8"?&gt;
</span><span class='line'>&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"&lt;br /&gt;
</span><span class='line'>    android:layout_width="fill_parent"&lt;br /&gt;
</span><span class='line'>    android:layout_height="fill_parent"&lt;br /&gt;
</span><span class='line'>    android:orientation="vertical"&gt;
</span><span class='line'>    &lt;Button&lt;br /&gt;
</span><span class='line'>        android:layout_width="fill_parent"&lt;br /&gt;
</span><span class='line'>        android:layout_height="wrap_content"&lt;br /&gt;
</span><span class='line'>        android:text="Copy Contacts"&lt;br /&gt;
</span><span class='line'>        android:onClick="copyContacts" /&gt;
</span><span class='line'>&lt;/LinearLayout&gt;</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import android.app.Activity;&lt;br /&gt;
</span><span class='line'>import android.app.Dialog;&lt;br /&gt;
</span><span class='line'>import android.app.ProgressDialog;&lt;br /&gt;
</span><span class='line'>import android.os.AsyncTask;&lt;br /&gt;
</span><span class='line'>import android.os.Bundle;&lt;br /&gt;
</span><span class='line'>import android.view.View;
</span><span class='line'>
</span><span class='line'>public class DialogTestActivity extends Activity {&lt;br /&gt;
</span><span class='line'>    private static final int COPY_CONTACTS = 0;
</span><span class='line'>
</span><span class='line'>    private ProgressDialog mProgressDialog;
</span><span class='line'>
</span><span class='line'>    @Override&lt;br /&gt;
</span><span class='line'>    public void onCreate(Bundle savedInstanceState) {&lt;br /&gt;
</span><span class='line'>        super.onCreate(savedInstanceState);&lt;br /&gt;
</span><span class='line'>        setContentView(R.layout.main);&lt;br /&gt;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    public void copyContacts(View target) {&lt;br /&gt;
</span><span class='line'>        showDialog(COPY_CONTACTS);&lt;br /&gt;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    @Override&lt;br /&gt;
</span><span class='line'>    protected Dialog onCreateDialog(int id) {&lt;br /&gt;
</span><span class='line'>        switch (id) {&lt;br /&gt;
</span><span class='line'>        case COPY_CONTACTS:&lt;br /&gt;
</span><span class='line'>            mProgressDialog = new ProgressDialog(this);&lt;br /&gt;
</span><span class='line'>            mProgressDialog.setTitle("Copy contacts");&lt;br /&gt;
</span><span class='line'>            mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);&lt;br /&gt;
</span><span class='line'>            mProgressDialog.setMax(100);&lt;br /&gt;
</span><span class='line'>            new AsyncCopyContactsTask().execute();&lt;br /&gt;
</span><span class='line'>            break;&lt;br /&gt;
</span><span class='line'>        }&lt;br /&gt;
</span><span class='line'>        return mProgressDialog;&lt;br /&gt;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    private class AsyncCopyContactsTask extends AsyncTask&lt;Void, Void, Integer&gt; {&lt;br /&gt;
</span><span class='line'>        @Override&lt;br /&gt;
</span><span class='line'>        protected Integer doInBackground(Void... params) {&lt;br /&gt;
</span><span class='line'>            for (int i = 0; i &lt; 100; i++) {&lt;br /&gt;
</span><span class='line'>                try {&lt;br /&gt;
</span><span class='line'>                    Thread.sleep(100);&lt;br /&gt;
</span><span class='line'>                } catch (InterruptedException e) {&lt;br /&gt;
</span><span class='line'>                }&lt;br /&gt;
</span><span class='line'>                publishProgress();&lt;br /&gt;
</span><span class='line'>            }&lt;br /&gt;
</span><span class='line'>            return 0;&lt;br /&gt;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        protected void onProgressUpdate(Void... progress) {&lt;br /&gt;
</span><span class='line'>            mProgressDialog.incrementProgressBy(1);&lt;br /&gt;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        protected void onPostExecute(Integer result) {&lt;br /&gt;
</span><span class='line'>            mProgressDialog.dismiss();&lt;br /&gt;
</span><span class='line'>        }&lt;br /&gt;
</span><span class='line'>    }&lt;br /&gt;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>第一次点击按钮会显示一个进度条，上面的数字处于变动当中，到达最大值后进度条会消失不见；再次点击按钮后，就会发现进度条上的数值和消失前相同，并且不再变化，而且进度条也不会消失。这是为什么呢？如果想每次打开对话框时进度条显示的内容都有所不同，该怎么做？</p>

<p>Activity中有三个和对话框显示有关的方法：showDialog()，dismissDialog()和removeDialog()。其中showDialog()用于显示一个对话框；dismissDialog()使对话框消失，但仍然处于内存中，只是不显示而已，如果再次调用showDialog()方法，则缓存在内存中的对话框会重新显示，而不需要重新创建。removeDialog()使对话框消失，并从内存中将对话框清除，如果再次调用showDialog()来显示它，则在显示之前需要重新创建对话框。</p>

<p>在一个对话框的声明周期内，onCreateDialog()仅被调用一次，但onPrepareDialog()方法会每次被调用。比如，第一次调用 showDialog()方法显示某个对话框时，会先触发onCreateDialog()的执行，然后再触发onPrepareDialog()方法；如果将某个对话框 removeDialog()后再showDialog()，也会先触发onCreateDialog()，接着触发onPrepareDialog()方法；如果某个对话框是被dismiss()掉的，再调用 showDialog()方法来显示它时就不会触发onCreateDialog()方法的执行，只会触发onPrepareDialog()方法。</p>

<p>这是因为第一次调用showDialog()时，Android从你的Activity中调用onCreateDialog()方法，得到返回的Dialog对象。把当前Activity设置为该对话框的所有者，从而把对话框挂靠到Activity上，让Activity自动管理该对话框的状态。这样，下次调用showDialog()时就不用重新创建Dialog对象，而是复用旧的。</p>

<p>注意：如果你决定在onCreateDialog()方法之外创建一个对话框，它将不会被附着到活动上。不过，你可以通过setOwnerActivity()把它附着到一个Activity上。</p>

<p>所以，解决再次打开ProgressDialog时进度条不变化的最好方法就是将mProgressDialog.dismiss()改成removeDialog(COPY_CONTACTS)。
</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/02/01/currency-war-confuse-the-reader-of-this-book-is-how-audio-visual/">《货币战争》这本书是如何混淆读者视听的</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-01T07:19:25+08:00" pubdate data-updated="true">Feb 1<sup>st</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>这是早就写好了的。《货币战争》刚发行就买了读了，看到三分之一的时候就看不下去了，准备写篇文章驳斥书中的观点，就列出了下面的提纲，不想文笔太差，一直没能把内容扩充起来，到现在也没了这个心思，这里把已经写的贴出来给大家看看吧。</p>

<p>1、读者们喜欢阴谋论；</p>

<p>2、美联储是私有的从来不是什么秘密。因为金融机构和公有私有无关，而是和财力及信用有关；</p>

<p>3、偷换概念，将金融家的被动行为说成是主动行为，造成一种金融家无所不能的环境；</p>

<p>4、放大作者想说的，缩小作者不想说的。只要是美国总统遇刺身亡就说是不符合金融家们的利益导致，那为什么不说别的国家呢？而且还忘了军队掌握在谁的手中，是人就知道给你个叛国罪啊什么的就能叫你金融家玩完，而且国家还有那么多秘密机构。其实这一招也是朝廷糊弄我们的方式。</p>

<p>货币战争真实存在：亚洲金融风暴，索罗斯狙击英镑这些都是货币战争，但是不应该把金融家的能力无限放大。</p>

<p>参考：
<a href="http://wenyidaobk.blog.163.com/blog/static/1243789052009712928966/"><a href="http://wenyidaobk.blog.163.com/blog/static/1243789052009712928966/">http://wenyidaobk.blog.163.com/blog/static/1243789052009712928966/</a></a>
</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/02/01/work-log-from-denial-to-acceptance-and-then-like/">工作日志：从拒绝到接受再到喜欢</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-01T07:04:08+08:00" pubdate data-updated="true">Feb 1<sup>st</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>刚毕业，在苏州一家公司工作，需要写工作日志，心里不喜欢，但不得不写，每天应付了事。现在想来大概是因为不知道写什么，怎么写的缘故（自觉语言贫乏，感觉好多话要说，但写出来却是干巴巴的几句，所以对一切需要动笔的如思想汇报，工作小结，年终总结等都特别不乐意，更别提上学时候的写作文了）。</p>

<p>到第二家公司，刚开始不要写，后来公司作了调整就要写了，这时是不再拒绝，以一种无所谓的态度接受了。</p>

<p>在第三家后，也是开始不要写，后来调整要写，不过由于有具体的日志格式，所以对这个还是非常接受的。</p>

<p>今天凌晨醒来后睡不着，在床上胡思乱想，突然想到工作日志的事。从管理人员的角度思考了工作日志的问题，有了一些新的想法，发现工作日志是管理人员了解工作进度的这么一个东西。在一个项目组里，项目经理可以通过你每天的工作日志对你今天的工作有一个大致的了解，综合所有小组成员的工作日志就可以对项目所处的状态有个大概。否则，每天只见你上班下班，坐在那里做事，但不知道你做了什么，做的怎么样，这样子怎么可能对项目的状态有所了解，项目就非常容易失控。</p>

<p>工作日志格式：</p>

<blockquote>
[main content]<br />
今天做了什么，完成度怎么样<br />
明天的计划又是什么

[questions]

[suggestions]
</blockquote>


<p>上面是我想的工作日志格式，我觉得明天的计划这一项非常重要，通过明天的计划以及当天工作完成的情况我们就可以了解我们制定的计划是否合理、有效。如果每天制定的计划都不能按时完成，那么说明对自己的能力估计过高，需要降低期望值，而项目经理可以通过某个组员一段时间内工作计划的完成度来了解组员的工作状态，如果组员一直处于计划不能按时完成状态，那么就要考虑是否要与组员沟通这个情况，帮助组员解决情况。</p>

<p>为什么要有个工作日志系统，而不是采用邮件的方式<br />
1、有文字记录（这个邮件也可以做到）；<br />
2、日志集中放置（这个邮件无法做到）；<br />
3、可以通过分析日志得出一些有用的统计（这个邮件无法做到）。
</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/01/15/huawei-hg526-telecommunications-cat-cracking-tutorial/">华为HG526电信猫破解教程</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-15T12:56:43+08:00" pubdate data-updated="true">Jan 15<sup>th</sup>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>把家里的电信从旧的4M套餐改为新的4M套餐，每月费用省了40多块，还送了个华为的HG526电信猫和iTV。拿到HG526后发现它带有无线路由功能，想着是不是可以让它自动拨号，以替换原来的ADSL猫和无线路由器。网上搜索一下，发现有很多教程，参考着资料一番实践，终于把设备给换了下来。这里做个笔记，把实践中碰到的问题和疑惑记录下来，分享给大家。</p>

<p>破解HG526的关键是获得超级用户telecomadmin的密码，通过以下步骤实现：<br />
1、准备U盘，在根目录下建立一个文件夹e8_Config_backup，插入华为HG526；<br />
2、用HG526的默认帐号（用户名useradmin）登录路由器192.168.1.1；<br />
3、在浏览器地址栏里输入 <a href="http://192.168.1.1/html/ehomeclient/cfgUSBRestore.cgi?coverusbpath=usb1_1">http://192.168.1.1/html/ehomeclient/cfgUSBRestore.cgi?coverusbpath=usb1_1</a> （注意大小写），提示备份成功；<br />
4、把U盘插入电脑，e8_Config_backup文件夹下多了一个文件ctce8_HG526.cfg；<br />
5、用附件中的工具把配置文件解密，找到telecomadmin帐号的密码；<br />
6、用超级用户telecomadmin登录，把远程管理关闭（不然密码就会被电信更改的）。</p>

<p>路由拨号配置</p>

<p>登录后，进入“网络”->“宽带设置”，在“连接名称”右边，选择“INTERNET_R_8_35”，按照下图配置，修改自己的上网账号和密码。
<img src="/uploads/hg526.png" title="hg526" ></p>

<p>这里有个问题，某些地方的VPI/VCI值是不一样的，本人所在区域值是0/100，所以上面应该选“INTERNET_B_0_100”。其它地方如果刷了不能用建议咨询下电信维护人员。</p>

<p>将破解的配置文件恢复到HG526中</p>

<p>在U盘的e8_Config_backup文件夹里放入破解修改后的ctce8_HG526.cfg文件，插入HG526。用超级用户登录，在“管理”->“设备管理”页面中，在“启用USB自动恢复配置文件”后面打上钩。然后点击“设备重启”。注意观察HG526以及U盘的指示灯，等HG526上所有的灯稳定了，配置也就刷进去了。</p>

<p>删除TR069协议，修改远程管理网址和域名</p>

<p>正常情况下“TR069_R_8_46”连接项在WEB配置页面中无法删除，但我们可以使用Web Developer插件来做到。在安装了Web Developer插件的Firefox中打开 <a href="http://192.168.1.1">http://192.168.1.1</a> ，用telecomadmin登录，进入“网络”—>“宽带设置”，在页面中点击右键，在Web Developer工具栏中选择“表单”->“开启 被禁用的表单”。然后你就可以删除TR069协议了。远程管理的修改与之类似。</p>

<p>关于TR069的解释：TR－069是由DSL论坛所开发的技术规范之一，其全称为“CPE广域网管理协议”。它提供了对下一代网络中家庭网络设备进行管理配置的通用框架和协议，用于从网络侧对家庭网络中的网关、路由器、机顶盒等设备进行远程集中管理。电信通过TR069协议修改我们的无线猫的配置，比如超级用户名密码，用户权限等，所以我们的配置文件里要关闭TR069，大家注意不要自己打开，否则一旦被改了超级用户名密码就惨了！</p>

<p>HG526配置文件加/解密软件：<a href="https://github.com/dohkoos/hw-hg526">https://github.com/dohkoos/hw-hg526</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/12/02/7-ways-to-develop-the-habit-of-immediate-action/">7个方法养成立即行动的习惯</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-02T05:10:11+08:00" pubdate data-updated="true">Dec 2<sup>nd</sup>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>英文原文：<a href="http://www.pickthebrain.com/blog/grow-the-action-habit/">7 Ways to Grow the Action Habit</a>
译文1：<a href="http://www.apple4.cn/2010/02/7-ways-to-grow-the-action-habit-be-a-doer-use-action-to-cure-fear-start-your-creative-engine-mechanically/">7步养成立即行动的习惯</a>
译文2：<a href="http://angelived.org/2008/10/03/7-ways-to-do-now/">立即行动的七个方法</a>
译文3：<a href="http://chorylee.blogbus.com/logs/17147004.html">七种建立你的行动习惯的方法</a></p>

<p>所有顶级成功人士都有一个共同的品质——那就是立即行动。这种品质可以取代智商，天赋和人际关系，来决定你的薪资范围和晋升速度。</p>

<p>尽管这个观念很简单，但是真正掌握它的人却是极少数。行动的习惯——把想法转换成立即行动的习惯——是完成任务必不可少的习惯。这里有7个方法让你养成立即行动的习惯：</p>

<p><strong>1、不要等到条件都完美了才行动</strong></p>

<p>如果你想等条件都完美了才开始行动，你可能永远都不会开始。因为总是会有些事情不是那么好。或是错过时机，行情不好，或是竞争太激烈。现实世界中没有完美的开始时间。你必须立即行动，等问题出现时再去解决它。开始行动的最佳时间是去年，其实便是现在。</p>

<p><strong>2、做个实干家</strong></p>

<p>行动胜于空想。你想开始实践吗？你有没有好的创意要告诉老板？今天就行动起来吧。想法停留在你脑子里时间越长，它就会变得越弱。几天之后，细节就会变得模糊。一周过去，你已经完全忘记它了。要想成为一个实干家，你需要做得更多，并在做的过程中产生更多新的想法。</p>

<p><strong>3、记住，想法本身并不能带来成功</strong></p>

<p>想法是很重要，但是它只有在被执行后才有价值。一个被付诸行动的平凡想法，比许多“某一天”或者“正确时机”再去实施的卓越创意更有价值。如果你有一个觉得真的很不错的想法，那么就去实现它。如果你不行动起来，那么这个想法永远不会被实现。</p>

<p><strong>4、用行动去克服恐惧</strong></p>

<p>你有没有注意到，在公众演讲中最恐惧的时刻是轮到你上场前那段等待的时刻？即使是专业的演讲者和演员也经历过表演前的焦虑。他们一旦开始，恐惧就会消失。行动是治疗恐惧的最佳方法。万事开头难。一旦行动起来，你将建立起自信，事情也会变得简单。通过行动来克服恐惧，通过行动来建立自信。</p>

<p><strong>5、机械地开启你的创造力</strong></p>

<p>人们对创造性工作的一大误解就是认为它只会在有灵感的时候产生。如果你一直等待灵感来敲门，那么你的作品就会很少。与其等待，不如机械地开启你的创造马达。如果你需要写些东西，那么强制自己坐下来后再写。笔尖在纸上滑动，思绪展开，开始写作，用你的笔激起你的伟大想法吧。</p>

<p><strong>6、先顾眼前</strong></p>

<p>把注意力集中在你当下可以做的事情上。不要去烦恼上周本该完成的事，也不要担心明天要完成的任务。你唯一能左右的时间就是现在。如果你过于考虑从前或者将来，你不会完成任何事情。明天或下周的事经常永远都不会发生。</p>

<p><strong>7、立即切入正题</strong></p>

<p>人们在开会前一般都会做些社交活动或着聊聊天。对于个体工作者也是如此。你在开始真正工作前多久会查看一次Email或RSS feeds呢？如果你不去绕过它们直接开始工作的话，这些分心的事情将会耗费你大量的时间。如果你做到了这点，你就会成为一个高效的人，别人也会把你当作领导者来看待。</p>

<p>没有上级的指示就采取行动，这需要勇气。或许这就是为何主动性是如此稀缺的才能，以至于大多经理都在寻找这种人才。争取主动，当你有一个好的想法的时候，立即去实现它，不要等别人来告诉你。一旦人们看到你在很认真地完成事情，他们就会想要加入你。成功人士不需要别人告诉他们该做什么。如果你想成为这样的人，那就应该习惯独立行动。
</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/11/16/simple-to-make-android-the-bottom-toolbar/">简单实现Android底部工具栏</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-16T01:08:52+08:00" pubdate data-updated="true">Nov 16<sup>th</sup>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在网上大部分教程中，底部工具栏通常由TabHost和RadioGroup结合完成，每个工具栏项对应一个独立的Activity。不过，我们要实现的是多个工具栏项在单独的一个Activity上起作用。</p>

<p><a href="http://www.cnblogs.com/figoyu/archive/2010/11/20/1882691.html"><a href="http://www.cnblogs.com/figoyu/archive/2010/11/20/1882691.html">http://www.cnblogs.com/figoyu/archive/2010/11/20/1882691.html</a></a>就是这个。不过该教程对每个工具栏项设置了固定宽度80dip，导致工具栏项或屏幕大小不定时代码布局会有问题。</p>

<p>这里对该教程做了些改进，使之能做到适应不定的工具栏项或屏幕大小。改进后的布局代码如下：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// main.xml&lt;br /&gt;
</span><span class='line'>&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;br /&gt;
</span><span class='line'>&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"&lt;br /&gt;
</span><span class='line'>    android:orientation="vertical"&lt;br /&gt;
</span><span class='line'>    android:layout_width="fill_parent"&lt;br /&gt;
</span><span class='line'>    android:layout_height="fill_parent"&gt;&lt;br /&gt;
</span><span class='line'>    &lt;LinearLayout&lt;br /&gt;
</span><span class='line'>        android:layout_width="fill_parent"&lt;br /&gt;
</span><span class='line'>        android:layout_height="0dip"&lt;br /&gt;
</span><span class='line'>        android:layout_weight="1.0"&gt;&lt;br /&gt;
</span><span class='line'>        &lt;ScrollView&lt;br /&gt;
</span><span class='line'>            android:layout_width="fill_parent"&lt;br /&gt;
</span><span class='line'>            android:layout_height="fill_parent"&lt;br /&gt;
</span><span class='line'>            android:scrollbars="vertical"&lt;br /&gt;
</span><span class='line'>            android:fadingEdge="vertical"&gt;&lt;br /&gt;
</span><span class='line'>            &lt;TextView&lt;br /&gt;
</span><span class='line'>                android:id="@+id/content"&lt;br /&gt;
</span><span class='line'>                android:layout_width="fill_parent"&lt;br /&gt;
</span><span class='line'>                android:layout_height="wrap_content"&lt;br /&gt;
</span><span class='line'>                android:textSize="17dip" /&gt;&lt;br /&gt;
</span><span class='line'>        &lt;/ScrollView&gt;&lt;br /&gt;
</span><span class='line'>    &lt;/LinearLayout&gt;
</span><span class='line'>
</span><span class='line'>    &lt;include layout="@layout/toolbar" /&gt;&lt;br /&gt;
</span><span class='line'>&lt;/LinearLayout&gt;&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>以下是工具栏的布局代码：<br />
&#8220;`
// toolbar.xml<br />
&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;utf-8&rdquo;?><br />
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br /></p>

<pre><code>android:orientation="horizontal"&lt;br /&gt;
android:layout_width="fill_parent"&lt;br /&gt;
android:layout_height="wrap_content"&lt;br /&gt;
android:background="@drawable/toolbar_bg"&gt;&lt;br /&gt;
&lt;ImageButton&lt;br /&gt;
    android:id="@+id/btn_index"&lt;br /&gt;
    android:src="@drawable/index"&lt;br /&gt;
    android:text="@string/index"&lt;br /&gt;
    style="@style/toolbar" /&gt;&lt;br /&gt;
&lt;ImageButton&lt;br /&gt;
    android:id="@+id/btn_prev"&lt;br /&gt;
    android:src="@drawable/btn_prev_bg"&lt;br /&gt;
    android:text="@string/prev"&lt;br /&gt;
    style="@style/toolbar" /&gt;&lt;br /&gt;
&lt;ImageButton&lt;br /&gt;
    android:id="@+id/btn_next"&lt;br /&gt;
    android:src="@drawable/btn_next_bg"&lt;br /&gt;
    android:text="@string/next"&lt;br /&gt;
    style="@style/toolbar" /&gt;&lt;br /&gt;
&lt;ImageButton&lt;br /&gt;
    android:id="@+id/btn_zoomin"&lt;br /&gt;
    android:src="@drawable/zoomin"&lt;br /&gt;
    android:text="@string/zoomin"&lt;br /&gt;
    style="@style/toolbar" /&gt;&lt;br /&gt;
&lt;ImageButton&lt;br /&gt;
    android:id="@+id/btn_zoomout"&lt;br /&gt;
    android:src="@drawable/zoomout"&lt;br /&gt;
    android:text="@string/zoomout"&lt;br /&gt;
    style="@style/toolbar" /&gt;&lt;br /&gt;
</code></pre>

<p></LinearLayout><br />
[/code]
</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/12/maven-archetype-to-create-the-initial-configuration-to-avoid-duplication-of-projects/">创建Maven Archetype避免重复项目初始配置</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-12T16:19:04+08:00" pubdate data-updated="true">Oct 12<sup>th</sup>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>有这么句话：遇到重复的项目初始配置，就要创建自己的Maven archetype。</p>

<p>手里就有这样的项目，其它项目都基于这个项目创建，只是对package名字做了修改，还有就是替换部分的图片，如何从现有项目中创建archetype呢？</p>

<p>首先，在已有项目的根目录下创建pom.xml，内容如下：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&lt;br /&gt;
</span><span class='line'>    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
</span><span class='line'>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
</span><span class='line'>
</span><span class='line'>    &lt;groupId&gt;your.company&lt;/groupId&gt;
</span><span class='line'>    &lt;artifactId&gt;artifact-name&lt;/artifactId&gt;
</span><span class='line'>    &lt;version&gt;1.0&lt;/version&gt;
</span><span class='line'>    &lt;packaging&gt;jar&lt;/packaging&gt;
</span><span class='line'>&lt;/project&gt;</span></code></pre></td></tr></table></div></figure>


<p>然后在根目录下执行下列命令（当然，在这之前你必须先配置好Maven环境）：<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn archetype:create-from-project&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>进入target\generated-sources\archetype目录，手工调整相关archetype源码。需进行变量替换的文件，要在archetype-metadata.xml中开启filtered=&ldquo;true&#8221;。</p>

<p>下面就是使用archetype了。<br /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn clean install&lt;br /&gt;
</span><span class='line'>mvn archetype:generate -DarchetypeArtifactId=artifact-name-archetype -DarchetypeGroupId=your.company -DgroupId=com.codemany -DartifactId=example -Dpackage=com.codemany.example&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/23/in-rails-simple-to-using-open-flash-chart-ii-tutorial/">在Rails中使用Open Flash Chart II简单教程</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-23T15:08:12+08:00" pubdate data-updated="true">Sep 23<sup>rd</sup>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天我们讲如何用Rails结合Open Flash Chart II（以下简称OFC2）实现如下的图表：
<img src="/uploads/ofc2-glassbar.png" title="ofc2-glassbar" ></p>

<p>在项目中安装OFC2插件，生成controller：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>script/plugin install git://github.com/pullmonkey/open_flash_chart.git&lt;br /&gt;
</span><span class='line'>script/generate controller stats index&lt;br /&gt;</span></code></pre></td></tr></table></div></figure>


<p>在生成的controller中添加以下代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class StatsController &lt; ApplicationController
</span><span class='line'>  def index
</span><span class='line'>    @graph = open_flash_chart_object(500, 300, "/stats/graph_code")
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  def graph_code
</span><span class='line'>    title = Title.new("Glass Bar")
</span><span class='line'>
</span><span class='line'>    bar = BarGlass.new
</span><span class='line'>    bar.set_values([-1,2,3,7,8,-7.3])
</span><span class='line'>
</span><span class='line'>    y = YAxis.new
</span><span class='line'>    y.set_range(-10, 10, 5)
</span><span class='line'>
</span><span class='line'>    chart = OpenFlashChart.new
</span><span class='line'>    chart.y_axis = y
</span><span class='line'>    chart.set_title(title)
</span><span class='line'>    chart.add_element(bar)
</span><span class='line'>    render :text =&gt; chart.to_s
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>将插件中的assets/javascripts/swfobject.js拷贝到public/javascripts目录下（可以看到该目录下已经有两个open-flash-chart开头的swf文件，如果没有的话，需要从插件中拷过来），在相应的view中添加代码：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;script src="/javascripts/swfobject.js" type="text/javascript"&gt;&lt;/script&gt;
</span><span class='line'>&lt;%= @graph %&gt;</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/16/spinner-sqlite-implementation-with-provincial-and-county-levels-linkage/">用Spinner + SQLite实现省市县三级联动</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-16T05:48:32+08:00" pubdate data-updated="true">Sep 16<sup>th</sup>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li>建立省市县<a href="http://www.stats.gov.cn/tjbz/xzqhdm/index.htm">行政区划代码</a>（截止2010年12月31日）数据表</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE xzqhdm (
</span><span class='line'>  _id INTEGER PRIMARY KEY,
</span><span class='line'>  code NUMERIC,
</span><span class='line'>  region TEXT,
</span><span class='line'>  parent_code NUMERIC
</span><span class='line'>);</span></code></pre></td></tr></table></div></figure>


<p>parent_code指上一级的行政区划代码，省属于最上级的行政单位，设置它的区划代码为999999。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>insert into xzqhdm values(NULL, 110000, "北京市", 999999);
</span><span class='line'>insert into xzqhdm values(NULL, 110100, "市辖区", 110000);
</span><span class='line'>insert into xzqhdm values(NULL, 110101, "东城区", 110100);
</span><span class='line'>insert into xzqhdm values(NULL, 110102, "西城区", 110100);
</span><span class='line'>insert into xzqhdm values(NULL, 110103, "崇文区", 110100);
</span><span class='line'>insert into xzqhdm values(NULL, 110104, "宣武区", 110100);
</span><span class='line'>insert into xzqhdm values(NULL, 110105, "朝阳区", 110100);
</span><span class='line'>insert into xzqhdm values(NULL, 110106, "丰台区", 110100);
</span><span class='line'>...
</span><span class='line'>insert into xzqhdm values(NULL, 659001, "石河子市", 659000);
</span><span class='line'>insert into xzqhdm values(NULL, 659002, "阿拉尔市", 659000);
</span><span class='line'>insert into xzqhdm values(NULL, 659003, "图木舒克市", 659000);
</span><span class='line'>insert into xzqhdm values(NULL, 659004, "五家渠市", 659000);</span></code></pre></td></tr></table></div></figure>


<p><strong>2. SQLite数据库的操作</strong>
如果应用使用到了SQLite数据库，在用户初次使用应用时，需要创建应用使用到的数据库表结构及添加一些初始化记录，另外在软件升级的时候，也需要对数据表结构进行更新。Android系统为我们提供了一个名为SQLiteOpenHelper的类，这是一个抽象类，该类用于对数据库版本进行管理，有两个重要的方法，分别是onCreate()和onUpgrade()。</p>

<p>当调用SQLiteOpenHelper的getWritableDatabase()或getReadableDatabase()方法获取数据库实例时，如果数据库不存在，Android系统会自动生成一个数据库文件，接着调用onCreate()方法，onCreate()方法在初次生成数据库时才会被调用，在onCreate()方法里可以生成数据库表结构及添加一些应用使用到的初始化数据。onUpgrade()方法在数据库的版本发生变化时会被调用，数据库的版本是由程序员控制的，假设数据库现在的版本是1，由于业务的需要，修改了数据库表的结构，这时候就需要升级软件，升级软件时希望更新用户手机里的数据库表结构，为了实现这一目的，可以把原来的数据库版本设置为2（或其他数值），并且在onUpgrade()方法里面实现表结构的更新。当软件的版本升级次数比较多，这时在onUpgrade()方法里面可以根据原版号和目标版本号进行判断，然后作出相应的表结构及数据更新。</p>

<p>SQLiteDatabase类则封装了一些操作数据库的常用API，使用该类可以完成对数据进行CRUD操作。主要是execSQL()和rawQuery()方法。execSQL()方法可以执行insert、delete、update和CREATE TABLE之类有更改行为的SQL语句； rawQuery()方法可以执行select语句。SQLiteDatabase还专门提供了对应于CRUD的操作方法： insert()、delete()、update()和query()。</p>

<p>问题：<br />
如何将SQLite数据库与apk文件一起发布？<br />
可以将数据库文件复制到res\raw目录中，所有在res\raw目录中的文件不会被压缩，这样可以直接提取该目录中的文件。</p>

<p>如何打开res\raw目录中的数据库文件？<br />
不能直接打开res\raw目录中的数据库文件，需要在程序第一次启动时将该文件复制到手机内存或SD卡中，然后再打开。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class DBHelper extends SQLiteOpenHelper {
</span><span class='line'>    private static String DB_PATH = "/data/data/com.codemany.linkage/databases/";
</span><span class='line'>    private static String DB_NAME = "xzqh.db";
</span><span class='line'>    private static DBHelper databaseHelper;
</span><span class='line'>    private static SQLiteDatabase db;
</span><span class='line'>
</span><span class='line'>    private Context context;
</span><span class='line'>
</span><span class='line'>    private DBHelper(Context context) {
</span><span class='line'>        super(context, DB_NAME, null, 1);
</span><span class='line'>        this.context = context;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    public static DBHelper getInstance(Context context) {
</span><span class='line'>        if (databaseHelper == null) {
</span><span class='line'>            databaseHelper = new DBHelper(context);
</span><span class='line'>            databaseHelper.openDataBase();
</span><span class='line'>
</span><span class='line'>            if (db == null) {
</span><span class='line'>                try {
</span><span class='line'>                    db = databaseHelper.getWritableDatabase();
</span><span class='line'>                    databaseHelper.copyDatabase();
</span><span class='line'>                }
</span><span class='line'>                catch (Exception e) {
</span><span class='line'>                    Log.d("DBHelper", "Error in database creation");
</span><span class='line'>                }
</span><span class='line'>
</span><span class='line'>                databaseHelper.openDataBase();
</span><span class='line'>            }
</span><span class='line'>        }
</span><span class='line'>        return databaseHelper;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    private void copyDatabase() throws IOException {
</span><span class='line'>        InputStream is = context.getResources().openRawResource(R.raw.xzqh);
</span><span class='line'>        OutputStream os = new FileOutputStream(DB_PATH + DB_NAME);
</span><span class='line'>        byte[] buffer = new byte[1024];
</span><span class='line'>        int length;
</span><span class='line'>        while ((length = is.read(buffer)) &gt; 0) {
</span><span class='line'>            os.write(buffer, 0, length);
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        os.flush();
</span><span class='line'>        os.close();
</span><span class='line'>        is.close();
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    private void openDataBase() {
</span><span class='line'>        try {
</span><span class='line'>            db = SQLiteDatabase.openDatabase(
</span><span class='line'>                    DB_PATH + DB_NAME,
</span><span class='line'>                    null,
</span><span class='line'>                    SQLiteDatabase.OPEN_READONLY | SQLiteDatabase.NO_LOCALIZED_COLLATORS);
</span><span class='line'>        } catch (SQLiteException e) {
</span><span class='line'>            // database does't exist yet
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    public SimpleCursorAdapter getListByParentCode(Context context, String parentCode) {
</span><span class='line'>        SimpleCursorAdapter list = null;
</span><span class='line'>        DBHelper dHelper = new DBHelper(context);
</span><span class='line'>        SQLiteDatabase db = dHelper.getReadableDatabase();
</span><span class='line'>        Cursor cursor = db.rawQuery(
</span><span class='line'>                "select code as _id, region from xzqhdm where parent_code = ?",
</span><span class='line'>                new String[] {parentCode});
</span><span class='line'>        if (cursor.getCount() != 0) {
</span><span class='line'>            list = new SimpleCursorAdapter(context,
</span><span class='line'>                    android.R.layout.simple_spinner_item,
</span><span class='line'>                    cursor,
</span><span class='line'>                    new String[] {"region"},
</span><span class='line'>                    new int[] {android.R.id.text1});
</span><span class='line'>            list.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
</span><span class='line'>        }
</span><span class='line'>        return list;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    @Override
</span><span class='line'>    public synchronized void close() {
</span><span class='line'>        if (db != null) {
</span><span class='line'>            db.close();
</span><span class='line'>        }
</span><span class='line'>        super.close();
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    @Override
</span><span class='line'>    public void onCreate(SQLiteDatabase db) {
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    @Override
</span><span class='line'>    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>在代码实现时遇到的难题是如何在选中region的同时得到对应的code。网上有教程说定制自己的adapter，重写bingView，不过有多个spinner就需要声明多个全局变量；还有教程指出可以直接往adapter中传递对象（实现一个类，将code和region作为字段），然后重写对象的toString()方法。后来受到这个帖子的启发，修改了rawQuery中的select语句得以实现Spinner控件中的键值绑定。</p>

<p>原来的select语句是：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>select _id, code, region from xzqhdm where parent_code = ?</span></code></pre></td></tr></table></div></figure>


<p>因为传入到CursorAdapter中的Cursor结果集必须包含有列名为<em>id的列，否则CursorAdapter将不会起作用。而code可以被看作是整数，那么只需要将选出的code当作</em>id就行了，根据这个想法写出的select语句如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>select code as _id, region from xzqhdm where parent_code = ?</span></code></pre></td></tr></table></div></figure>


<p>这样，但触发Spinner上的ItemSelected事件时就可以通过最后一个参数id得到当前的code了。</p>

<p>写这篇文章的时候同时也在调试着代码，突然发现其实不需要改写select语句也是可以实现键值绑定的。只要在onItemSelected()方法中使用如下代码就可以取得相应的值了：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Cursor cursor = (Cursor)parent.getSelectedItem();
</span><span class='line'>if (cursor != null) {
</span><span class='line'>    int code = cursor.getString(cursor.getColumnIndex("code"));
</span><span class='line'>    String country = cursor.getString(cursor.getColumnIndex("region"));
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p><a href="/uploads/linkage.zip" title="linkage.zip">代码下载</a></p>

<p>参考文章：<br />
<a href="http://lxmgfd.iteye.com/blog/970637">http://lxmgfd.iteye.com/blog/970637</a><br />
<a href="http://www.eoeandroid.com/thread-98254-1-1.html">http://www.eoeandroid.com/thread-98254-1-1.html</a><br />
<a href="http://www.cmd100.com/bbs/thread-5454-1-1.html">http://www.cmd100.com/bbs/thread-5454-1-1.html</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/6">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/4">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/07/17/problem-with-nokogiri-when-url-containing-chinese-character/">Nokogiri抓取页面URL含有中文参数的问题</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/09/logic-problems-how-many-sick-dogs/">逻辑题-几条病狗</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/07/debugging-rails-with-pry/">使用Pry调试Rails项目</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/06/raspberry-pi-wifi-with-static-ip-address/">Raspberry Pi使用无线网卡</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/28/how-i-made-ruby-script-156x-faster/">我是如何让Ruby脚本速度提升156倍的</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Recent Comments</h1>
  <div class="dsq-widget">
    <script type="text/javascript" src="http://dohkoos.disqus.com/recent_comments_widget.js"></script>
  </div>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
    <a style="font-size: 133%" href="/tags/android/">Android</a>
<a style="font-size: 111%" href="/tags/crack/">Crack</a>
<a style="font-size: 108%" href="/tags/database/">Database</a>
<a style="font-size: 105%" href="/tags/jbookshelf/">JBookShelf</a>
<a style="font-size: 132%" href="/tags/java/">Java</a>
<a style="font-size: 97%" href="/tags/listview/">ListView</a>
<a style="font-size: 108%" href="/tags/mysql/">MySQL</a>
<a style="font-size: 116%" href="/tags/powerbuilder/">PowerBuilder</a>
<a style="font-size: 120%" href="/tags/qianbao/">Qianbao</a>
<a style="font-size: 150%" href="/tags/rails/">Rails</a>
<a style="font-size: 101%" href="/tags/ruby/">Ruby</a>
<a style="font-size: 101%" href="/tags/struts/">Struts</a>
<a style="font-size: 97%" href="/tags/ubuntu/">Ubuntu</a>
<a style="font-size: 105%" href="/tags/windows-server-2008/">Windows Server 2008</a>
<a style="font-size: 108%" href="/tags/wxwidgets/">wxWidgets</a>

  </ul>
</section>
<section>
  <h1>Blogroll</h1>
  <ul>
    <li><a href="http://mindhacks.cn/">刘未鹏MIND HACKS</a></li>
    <li><a href="http://quake.iteye.com/">写程序的70后</a></li>
    <li><a href="http://codingnow.com/">云风的 BLOG</a></li>
    <li><a href="http://dbanotes.net/">DBA Notes</a></li>
    <li><a href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志</a></li>
    <li><a href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html">Data Structure Visualization</a></li>
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - dohkoos -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dohkoos';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
