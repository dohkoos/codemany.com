
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>乐者为王</title>
  <meta name="author" content="dohkoos">

  
  <meta name="description" content="Eclipse 3.0.3 + Ant 1.6.2 + JUnit 3.8.1 构建配置文件build.xml： 1
2
3
4
5
6
7
8
&lt;target name="junit"&gt; &lt;junit&gt; &lt;formatter type="xml" /&gt; &lt &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://codemany.com/posts/22">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="乐者为王" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <!--script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script-->
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"-->
<!--link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"-->

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">乐者为王</a></h1>
  
    <h2>Do one thing, and do it well.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:codemany.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2005/02/22/problem-running-junit-tests-with-ant-in-eclipse-part2/">Eclipse中Ant结合JUnit自动测试的问题（2）</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-02-22T22:02:00+08:00" pubdate data-updated="true">Feb 22<sup>nd</sup>, 2005</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Eclipse 3.0.3 + Ant 1.6.2 + JUnit 3.8.1</p>

<p>构建配置文件build.xml：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;target name="junit"&gt;
</span><span class='line'>    &lt;junit&gt;
</span><span class='line'>        &lt;formatter type="xml" /&gt;
</span><span class='line'>        &lt;batchtest todir="${report.dir}"&gt;
</span><span class='line'>            &lt;fileset dir="${classes.dir}" includes="**/*Test.class" /&gt;
</span><span class='line'>        &lt;/batchtest&gt;
</span><span class='line'>    &lt;/junit&gt;
</span><span class='line'>&lt;/target&gt;</span></code></pre></td></tr></table></div></figure>


<p>执行任务的时候出现了异常：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>java.lang.ClassNotFoundException: com.example.lesson.HelloTest
</span><span class='line'>    at java.net.URLClassLoader$1.run(Unknown Source)
</span><span class='line'>    at java.security.AccessController.doPrivileged(Native Method)
</span><span class='line'>    at java.net.URLClassLoader.findClass(Unknown Source)
</span><span class='line'>    at java.lang.ClassLoader.loadClass(Unknown Source)
</span><span class='line'>    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
</span><span class='line'>    at java.lang.ClassLoader.loadClass(Unknown Source)
</span><span class='line'>    at java.lang.ClassLoader.loadClassInternal(Unknown Source)
</span><span class='line'>    at java.lang.Class.forName0(Native Method)
</span><span class='line'>    at java.lang.Class.forName(Unknown Source)</span></code></pre></td></tr></table></div></figure>


<p>网上搜索没有找到答案，到Ant官网上发现 <a href="http://ant.apache.org/faq.html#delegating-classloader">http://ant.apache.org/faq.html#delegating-classloader</a> 这篇文章讲了该问题。只要在junit任务里加入classpath指出要加载类的路径就可以了。修改后的build.xml文件如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;target name="junit"&gt;
</span><span class='line'>    &lt;junit&gt;
</span><span class='line'>        &lt;classpath&gt;
</span><span class='line'>            &lt;pathelement location="${classes.dir}" /&gt;
</span><span class='line'>        &lt;/classpath&gt;
</span><span class='line'>        &lt;formatter type="xml" /&gt;
</span><span class='line'>        &lt;batchtest todir="${report.dir}"&gt;
</span><span class='line'>            &lt;fileset dir="${classes.dir}" includes="**/*Test.class" /&gt;
</span><span class='line'>        &lt;/batchtest&gt;
</span><span class='line'>    &lt;/junit&gt;
</span><span class='line'>&lt;/target&gt;</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2005/02/05/problem-running-junit-tests-with-ant-in-eclipse-part1/">Eclipse中Ant结合JUnit自动测试的问题（1）</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-02-05T18:33:00+08:00" pubdate data-updated="true">Feb 5<sup>th</sup>, 2005</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Eclipse 3.0.3 + Ant 1.6.2 + JUnit 3.8.1</p>

<p>构建配置文件build.xml：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;target name="junit"&gt;
</span><span class='line'>    &lt;junit&gt;
</span><span class='line'>        &lt;formatter type="xml" /&gt;
</span><span class='line'>        &lt;batchtest todir="${report.dir}"&gt;
</span><span class='line'>            &lt;fileset dir="${classes.dir}" includes="**/*Test.class" /&gt;
</span><span class='line'>        &lt;/batchtest&gt;
</span><span class='line'>    &lt;/junit&gt;
</span><span class='line'>&lt;/target&gt;</span></code></pre></td></tr></table></div></figure>


<p>在执行时出现了以下问题：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>BUILD FAILED: build.xml:44: Could not create task or type of type: junit.
</span><span class='line'>
</span><span class='line'>Ant could not find the task or a class this task relies upon.
</span><span class='line'>
</span><span class='line'>This is common and has a number of causes; the usual
</span><span class='line'>solutions are to read the manual pages then download and
</span><span class='line'>install needed JAR files, or fix the build file:
</span><span class='line'> - You have misspelt 'junit'.
</span><span class='line'>   Fix: check your spelling.
</span><span class='line'> - The task needs an external JAR file to execute
</span><span class='line'>     and this is not found at the right place in the classpath.
</span><span class='line'>   Fix: check the documentation for dependencies.
</span><span class='line'>   Fix: declare the task.
</span><span class='line'> - The task is an Ant optional task and the JAR file and/or libraries
</span><span class='line'>     implementing the functionality were not found at the time you
</span><span class='line'>     yourself built your installation of Ant from the Ant sources.
</span><span class='line'>   Fix: Look in the ANT_HOME/lib for the 'ant-' JAR corresponding to the
</span><span class='line'>     task and make sure it contains more than merely a META-INF/MANIFEST.MF.
</span><span class='line'>     If all it contains is the manifest, then rebuild Ant with the needed
</span><span class='line'>     libraries present in ${ant.home}/lib/optional/, or alternatively,
</span><span class='line'>     download a pre-built release version from apache.org
</span><span class='line'> - The build file was written for a later version of Ant
</span><span class='line'>   Fix: upgrade to at least the latest release version of Ant
</span><span class='line'> - The task is not an Ant core or optional task
</span><span class='line'>     and needs to be declared using &lt;taskdef&gt;.
</span><span class='line'> - You are attempting to use a task defined using
</span><span class='line'>    &lt;presetdef&gt; or &lt;macrodef&gt; but have spelt wrong or not
</span><span class='line'>   defined it at the point of use
</span><span class='line'>
</span><span class='line'>Remember that for JAR files to be visible to Ant tasks implemented
</span><span class='line'>in ANT_HOME/lib, the files must be in the same directory or on the
</span><span class='line'>classpath
</span><span class='line'>
</span><span class='line'>Please neither file bug reports on this problem, nor email the
</span><span class='line'>Ant mailing lists, until all of these causes have been explored,
</span><span class='line'>as this is not an Ant bug.</span></code></pre></td></tr></table></div></figure>


<p>产生上面错误的原因是Ant在执行junit任务时没有找到junit.jar这个文件。将junit.jar放到ANT_HOME/lib目录下，再次执行，这下该OK了吧！</p>

<p>有没有搞错，还产生同样的错误！到命令行下试试。打入命令ant junit，然后出现：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Buildfile: build.xml
</span><span class='line'>
</span><span class='line'>junit:
</span><span class='line'>
</span><span class='line'>BUILD SUCCESSFUL
</span><span class='line'>Total time: 1 second</span></code></pre></td></tr></table></div></figure>


<p>怎么会这样？命令行下可以，Eclipse中就不行了？</p>

<p>到Preferences -> Ant -> Runtime -> Classpath下设置一下junit.jar的路径，再次执行junit任务，终于在Console视图中看到了成功的消息。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2005/01/31/the-operating-system-partition-type-list/">操作系统分区类型大全</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-01-31T13:05:09+08:00" pubdate data-updated="true">Jan 31<sup>st</sup>, 2005</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>大概是最全的操作系统分区类型列表了^_^</p>

<table>
<thead>
<tr>
<th>分区类型 </th>
<th> 操作系统           </th>
<th></th>
<th> 分区类型 </th>
<th> 操作系统</th>
</tr>
</thead>
<tbody>
<tr>
<td>   0x0   </td>
<td> UNUSED             </td>
<td></td>
<td>   0x80   </td>
<td> Old Minix</td>
</tr>
<tr>
<td>   0x1   </td>
<td> DOS FAT12          </td>
<td></td>
<td>   0x81   </td>
<td> Minix/Old Linux</td>
</tr>
<tr>
<td>   0x2   </td>
<td> Xenix root         </td>
<td></td>
<td>   0x82   </td>
<td> Linux Swap</td>
</tr>
<tr>
<td>   0x3   </td>
<td> Xenix user         </td>
<td></td>
<td>   0x83   </td>
<td> Linux EXT2</td>
</tr>
<tr>
<td>   0x4   </td>
<td> DOS FAT16 &lt; 32MB   </td>
<td></td>
<td>   0x84   </td>
<td></td>
</tr>
<tr>
<td>   0x5   </td>
<td> DOS Extended       </td>
<td></td>
<td>   0x85   </td>
<td> Linux EXT</td>
</tr>
<tr>
<td>   0x6   </td>
<td> DOS FAT16 >= 32M   </td>
<td></td>
<td>   0x86   </td>
<td></td>
</tr>
<tr>
<td>   0x7   </td>
<td> HPFS/NTFS          </td>
<td></td>
<td>   0x87   </td>
<td></td>
</tr>
<tr>
<td>   0x8   </td>
<td> AIX                </td>
<td></td>
<td>   0x88   </td>
<td></td>
</tr>
<tr>
<td>   0x9   </td>
<td> AIX bootable       </td>
<td></td>
<td>   0x89   </td>
<td></td>
</tr>
<tr>
<td>   0xA   </td>
<td> OS/2 boot manager  </td>
<td></td>
<td>   0x8A   </td>
<td></td>
</tr>
<tr>
<td>   0xB   </td>
<td> OS FAT32           </td>
<td></td>
<td>   0x8B   </td>
<td></td>
</tr>
<tr>
<td>   0xC   </td>
<td> DOS FAT Cyl > 1024 </td>
<td></td>
<td>   0x8C   </td>
<td></td>
</tr>
<tr>
<td>   0xE   </td>
<td> DOS FAT system     </td>
<td></td>
<td>   0x8E   </td>
<td></td>
</tr>
<tr>
<td>   0xF   </td>
<td> DOS big Extended   </td>
<td></td>
<td>   0x8F   </td>
<td></td>
</tr>
<tr>
<td>   0x13  </td>
<td>                    </td>
<td></td>
<td>   0x93   </td>
<td> Amoeba</td>
</tr>
<tr>
<td>   0x14  </td>
<td>                    </td>
<td></td>
<td>   0x94   </td>
<td> Amoeba BBT</td>
</tr>
<tr>
<td>   0x25  </td>
<td>                    </td>
<td></td>
<td>   0xA5   </td>
<td> FreeBSD</td>
</tr>
<tr>
<td>   0x26  </td>
<td> [Hidden]           </td>
<td></td>
<td>   0xA6   </td>
<td> OpenBSD</td>
</tr>
<tr>
<td>   0x27  </td>
<td>                    </td>
<td></td>
<td>   0xA7   </td>
<td> NeXT STEP</td>
</tr>
<tr>
<td>   0x29  </td>
<td>                    </td>
<td></td>
<td>   0xA9   </td>
<td> NetBSD</td>
</tr>
<tr>
<td>   0x37  </td>
<td>                    </td>
<td></td>
<td>   0xB7   </td>
<td> BSDI</td>
</tr>
<tr>
<td>   0x38  </td>
<td>                    </td>
<td></td>
<td>   0xB8   </td>
<td> BSDI Swap</td>
</tr>
<tr>
<td>   0x40  </td>
<td> Venix 80286        </td>
<td></td>
<td>   0xC0   </td>
<td></td>
</tr>
<tr>
<td>   0x41  </td>
<td> PPC PReP boot      </td>
<td></td>
<td>   0xC1   </td>
<td></td>
</tr>
<tr>
<td>   0x47  </td>
<td>                    </td>
<td></td>
<td>   0xC7   </td>
<td> Syrinx</td>
</tr>
<tr>
<td>   0x51  </td>
<td> Novell ?           </td>
<td></td>
<td>   0xD1   </td>
<td></td>
</tr>
<tr>
<td>   0x52  </td>
<td> MicroPort          </td>
<td></td>
<td>   0xD2   </td>
<td></td>
</tr>
<tr>
<td>   0x5B  </td>
<td>                    </td>
<td></td>
<td>   0xDB   </td>
<td> CP/M</td>
</tr>
<tr>
<td>   0x61  </td>
<td>                    </td>
<td></td>
<td>   0xE1   </td>
<td> DOS access</td>
</tr>
<tr>
<td>   0x63  </td>
<td> GNU hurd           </td>
<td></td>
<td>   0xE3   </td>
<td> DOS R/0</td>
</tr>
<tr>
<td>   0x64  </td>
<td> Novell NetWare     </td>
<td></td>
<td>   0xE4   </td>
<td></td>
</tr>
<tr>
<td>   0x65  </td>
<td> Novell NetWare     </td>
<td></td>
<td>   0xE5   </td>
<td></td>
</tr>
<tr>
<td>   0x6B  </td>
<td>                    </td>
<td></td>
<td>   0xEB   </td>
<td> BeOS</td>
</tr>
<tr>
<td>   0x72  </td>
<td>                    </td>
<td></td>
<td>   0xF2   </td>
<td> DOS secondary</td>
</tr>
<tr>
<td>   0x75  </td>
<td> PC/IX              </td>
<td></td>
<td>   0xF5   </td>
<td></td>
</tr>
<tr>
<td>   0x7F  </td>
<td>                    </td>
<td></td>
<td>   0xFF   </td>
<td> BBT</td>
</tr>
</tbody>
</table>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2005/01/12/how-to-insert-line-breaks-into-textarea-with-jsp/">JSP中怎样输出\r\n到textarea中</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-01-12T12:47:51+08:00" pubdate data-updated="true">Jan 12<sup>th</sup>, 2005</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>测试代码如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;%
</span><span class='line'>    String str = "first line\r\nsecond line";
</span><span class='line'>%&gt;
</span><span class='line'>
</span><span class='line'>&lt;body&gt;
</span><span class='line'>    &lt;textarea id="editor" name="editor"&gt;&lt;/textarea&gt;;
</span><span class='line'>&lt;/body&gt;
</span><span class='line'>
</span><span class='line'>&lt;script language="javascript"&gt;
</span><span class='line'>&lt;!–-
</span><span class='line'>    var editor = document.getElementById('editor');
</span><span class='line'>    editor.value = '&lt;%= str.replaceAll("\r\n", "\\\\r\\\\n") %&gt;';
</span><span class='line'>//-–&gt;
</span><span class='line'>&lt;/script&gt;</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/12/04/forgot-root-password-for-linux/">忘记Linux的root密码后</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-04T18:29:10+08:00" pubdate data-updated="true">Dec 4<sup>th</sup>, 2004</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>一不小心忘记了Linux的root密码，只能以普通用户ffat的身份进入系统了。</p>

<p>找到Linux的DISC 1安装光盘，从光盘启动，出现boot:引导符后输入（其中，/dev/hda3是Linux系统所在的分区）：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>linux single root=/dev/hda3 initrd=</span></code></pre></td></tr></table></div></figure>


<p>进入系统，拷贝/etc目录下的shadow和passwd文件到/home/ffat目录下，修改shadow文件的属性。再到 <a href="http://www.openwall.com/john/">http://www.openwall.com/john/</a> 下载一个John the Ripper，编译安装好后输入：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./unshadow passwd shadow &gt; passwd.1</span></code></pre></td></tr></table></div></figure>


<p>接着运行破解：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>john passwd.1</span></code></pre></td></tr></table></div></figure>


<p>这样过了半个多小时我的root密码就回来了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/12/01/install-and-configure-jdk150-on-linux/">Linux下JDK 1.5.0的安装和配置</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-12-01T11:28:09+08:00" pubdate data-updated="true">Dec 1<sup>st</sup>, 2004</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>先是在网上找了两篇在Linux上安装JDK的文章：<a href="http://www.cnblogs.com/sirsunny/archive/2004/11/22/67029.html">http://www.cnblogs.com/sirsunny/archive/2004/11/22/67029.html</a> 和 <a href="http://dev.csdn.net/article/46/article/46/46877.shtm">http://dev.csdn.net/article/46/article/46/46877.shtm</a> 。</p>

<p>觉得后者写的比较详细，就照着它来了。步骤1、2、3没问题，把JDK安装好了，现在要配置环境变量了，有3种方法，哪种好呢？第1种不方便，换个shell登陆就不行了，第3种也不好，所有登陆用户都能用，那就只能选择第2种方法了。用vi打开.bashrc文件，在文件末尾添加以下内容：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>set JAVA_HOME=/usr/java/jdk1.5.0
</span><span class='line'>export JAVA_HOME
</span><span class='line'>set PATH=$PATH:$JAVA_HOME/bin
</span><span class='line'>export PATH
</span><span class='line'>set CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
</span><span class='line'>export CLASSPATH</span></code></pre></td></tr></table></div></figure>


<p>现在文件内容为：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># .bashrc
</span><span class='line'># User specific aliases and functions
</span><span class='line'>
</span><span class='line'># Source global definitions
</span><span class='line'>if [ -f /etc/bashrc ]; then
</span><span class='line'>    . /etc/bashrc
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>set JAVA_HOME=/usr/java/jdk1.5.0
</span><span class='line'>export JAVA_HOME
</span><span class='line'>set PATH=$PATH:$JAVA_HOME/bin
</span><span class='line'>export PATH
</span><span class='line'>set CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
</span><span class='line'>export CLASSPATH</span></code></pre></td></tr></table></div></figure>


<p>然后重新登陆，用echo $JAVA_HOME查看环境变量，咦，怎么是空的呢？肯定有什么地方出错了，是不是不要什么set啊，试试把set去掉看看，修改后的.bashrc文件内容如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># .bashrc
</span><span class='line'># User specific aliases and functions
</span><span class='line'>
</span><span class='line'># Source global definitions
</span><span class='line'>if [ -f /etc/bashrc ]; then
</span><span class='line'>    . /etc/bashrc
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>JAVA_HOME=/usr/java/j2sdk1.5.0
</span><span class='line'>export JAVA_HOME
</span><span class='line'>PATH=$PATH:$JAVA_HOME/bin
</span><span class='line'>export PATH
</span><span class='line'>CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
</span><span class='line'>export CLASSPATH</span></code></pre></td></tr></table></div></figure>


<p>再执行echo $JAVA_HOME命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/usr/java/jdk1.5.0/</span></code></pre></td></tr></table></div></figure>


<p>果然，去掉set后环境变量就正确了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/11/23/inside-protected-mode/">Inside Protected Mode</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-11-23T13:10:07+08:00" pubdate data-updated="true">Nov 23<sup>rd</sup>, 2004</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>以下所说的书指的是杨季文的《80X86汇编语言程序设计教程》。</p>

<p>在380页，他说是“在实方式下被预取，在保护方式下被执行”。这个说法不太正确。现在就来说说在进/出保护模式时究竟发生了什么？</p>

<p>在实模式时，通过指令lgdt fword ptr vgdtr把vgdtr处6个字节的内容装入GDTR中（记住，仅仅只是装入）。然后打开A20地址线（打开A20地址线是为了能存取1M以上的内存，和进不进保护模式其实没有必然的联系，也就是说不打开A20也能进入保护模式，只不过这时在保护模式下就不能存取1M以上的内存了）。然后把CR0寄存器的PE位置1，这是告诉CPU开启保护模式。</p>

<p>讲到这里，就要先来说说shadow cache了。shadow cache的layout可以看388页。在实模式下的时候有些位是只读的。大家还记的实模式下取址的方法吗？对，段寄存器值 * 16 + offset。是直接由MMU这样做然后再取址的吗？不是，实际上是：当你往段寄存器（比如说CS）送值后，MMU同时会把CS * 16的值放入到CS的shadow cache中。这样以后只要不改变CS的值，那么，在同一段代码段中的寻址将是offset加上shadow cache中的段基址部分。明白了吗？好，我们再回过来讲。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mov eax, cr0
</span><span class='line'>or eax, 1
</span><span class='line'>mov cr0, eax</span></code></pre></td></tr></table></div></figure>


<p>这段代码究竟做了什么呢？其实它做的是开放段寄存器shadow cache的每个位（也就是每个位的值都能修改了，而在实模式下有些位是只读的）。还有就是告诉CPU开启保护模式。记住，这时候在shadow cache中的内容还没有变，还是原来实模式下的地址值。</p>

<p>现在再来谈谈保护模式下的寻址。在386以后的机器，保护模式下的寻址其实和在实模式下的寻址是一样的，也是offset加上shadow cache中的段基址部分。这样就可以理解为什么把CR0的PE位置1后还能执行后面的指令了。因为把CR0的PE位置1虽然使系统进入了保护模式。但因为在shadow cache中的内容还是实模式下的内容，所以才能在保护模式下执行实地址处的指令。然后呢！看看jump指令做了什么？</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>jump selector, offset</span></code></pre></td></tr></table></div></figure>


<p>这个指令做了什么？它的意思是要跳到选择子为selector的段的偏移为offset处，执行那里的指令。这时CPU究竟做了什么呢？因为是段间跳转（就是带selector的跳转啦）。又因为现在是在保护模式下，所以MMU根据selector从GDT（知道LDGT的作用了吧）来找到段的真实段基址，然后再把它放入到相应段的shadow cache中。接着MMU再把offset和（shadow cache中的段基址部分）相加。这样就得到了下一个指令的地址。同样的道理，从保护模式出来时用</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mov eax，cr0
</span><span class='line'>and eax，0xffffffff
</span><span class='line'>mov cr0，eax</span></code></pre></td></tr></table></div></figure>


<p>使各段的shadow cache中一部分位固定，并且宣告进入实模式，即以后的寻址将采用实模式方式。然后通过执行jump cs, offset来把CS * 16的值装入shadow cache中。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/11/03/source-not-found-for-in-eclipse-when-debugging-servlet/">在Eclipse下调试Servlet时出现Source Not Found For</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-11-03T11:03:19+08:00" pubdate data-updated="true">Nov 3<sup>rd</sup>, 2004</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在Eclipse下调试Servlet出现了Source not found for HelloAction.execute (&#8230;)的问题，猜想是没有将Servlet代码加入到debug路径下以致在调试的时候找不到source，虽然知道原因，却不知道怎么解决。就在Eclipse里乱逛，东点西击，最后终于找到了解决问题所在。</p>

<p>进入Window -> Preferences -> Tomcat -> Source Path，在Source Path标签下有行文字：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Add java projects to source path (Eclipse debugger will search for source files in these projects).</span></code></pre></td></tr></table></div></figure>


<p>将要调试的project选中然后再调试，果然不再出现Source not found for了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2004/10/24/the-meaning-of-the-thread-dump/">Thread Dump信息的含义</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2004-10-24T14:37:00+08:00" pubdate data-updated="true">Oct 24<sup>th</sup>, 2004</time>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"Thread-0" prio=5 tid=0xafde0 nid=0x72a00 runnable [0x173f000..0x173fb48]
</span><span class='line'>    at java.net.PlainSocketImpl.socketAccept(Native Method)
</span><span class='line'>    at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:421)
</span><span class='line'>    at java.net.ServerSocket.implAccept(ServerSocket.java:243)
</span><span class='line'>    at java.net.ServerSocket.accept(ServerSocket.java:222)
</span><span class='line'>    at com.generationjava.net.PortListener.run(PortListener.java:333)
</span><span class='line'>    at java.lang.Thread.run(Thread.java:496)</span></code></pre></td></tr></table></div></figure>


<p>Thread-0表示线程名，prio表示这个线程的优先级，tid是这个线程的id号，nid是这个线程对应的本地线程id号。</p>

<p>runnable是线程的状态，其它状态可查看jvmti.h头文件。</p>

<p>[0x173f000..0x173fb48]是线程占用内存地址情况的说明。</p>

<p>java.net.PlainSocketImpl.socketAccept(Native Method)表示调用了java.net.PlainSocketImpl类中的socketAccept方法，socketAccept方法是一个本地方法，且在调用这个本地方法时出了错。</p>

<p>java.net.PlainSocketImpl.accept(PlainSocketImpl.java:421)表示调用了java.net.PlainSocketImpl类中的accept方法。accept在PlainSocketImpl.java文件中的421行。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/21">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/08/05/migrating-wordpress-to-octopress/">Wordpress迁移到Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/17/problem-with-nokogiri-when-url-containing-chinese-character/">Nokogiri抓取页面URL含有中文参数的问题</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/09/logic-problems-how-many-sick-dogs/">逻辑题-几条病狗</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/07/debugging-rails-with-pry/">使用Pry调试Rails项目</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/06/raspberry-pi-wifi-with-static-ip-address/">Raspberry Pi使用无线网卡</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Recent Comments</h1>
  <div class="dsq-widget">
    <script type="text/javascript" src="http://codemany.disqus.com/recent_comments_widget.js"></script>
  </div>
</section>
<section>
  <h1>Tags</h1>
  <ul class="tag-cloud">
    <a style="font-size: 133%" href="/tags/android/">Android</a>
<a style="font-size: 111%" href="/tags/crack/">Crack</a>
<a style="font-size: 108%" href="/tags/database/">Database</a>
<a style="font-size: 97%" href="/tags/eclipse/">Eclipse</a>
<a style="font-size: 105%" href="/tags/jbookshelf/">JBookShelf</a>
<a style="font-size: 135%" href="/tags/java/">Java</a>
<a style="font-size: 108%" href="/tags/mysql/">MySQL</a>
<a style="font-size: 116%" href="/tags/powerbuilder/">PowerBuilder</a>
<a style="font-size: 120%" href="/tags/qianbao/">Qianbao</a>
<a style="font-size: 150%" href="/tags/rails/">Rails</a>
<a style="font-size: 101%" href="/tags/ruby/">Ruby</a>
<a style="font-size: 101%" href="/tags/struts/">Struts</a>
<a style="font-size: 97%" href="/tags/translation/">Translation</a>
<a style="font-size: 105%" href="/tags/windows-server-2008/">Windows Server 2008</a>
<a style="font-size: 108%" href="/tags/wxwidgets/">wxWidgets</a>

  </ul>
</section>
<section>
  <h1>Blogroll</h1>
  <ul>
    <li><a href="http://mindhacks.cn/">刘未鹏MIND HACKS</a></li>
    <li><a href="http://quake.iteye.com/">写程序的70后</a></li>
    <li><a href="http://codingnow.com/">云风的 BLOG</a></li>
    <li><a href="http://dbanotes.net/">DBA Notes</a></li>
    <li><a href="http://www.ruanyifeng.com/blog/">阮一峰的网络日志</a></li>
    <li><a href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html">Data Structure Visualization</a></li>
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - dohkoos -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'codemany';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
