<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: UC Browser | 乐者为王]]></title>
  <link href="http://codemany.com/tags/uc-browser/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2014-08-27T22:06:19+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[导入UC Browser书签到Firefox中]]></title>
    <link href="http://codemany.com/blog/2011/07/02/import-uc-browser-bookmarks-into-firefox/"/>
    <updated>2011-07-02T16:03:41+08:00</updated>
    <id>http://codemany.com/blog/2011/07/02/import-uc-browser-bookmarks-into-firefox</id>
    <content type="html"><![CDATA[<p>UC Browser保存的书签后缀名是aucf，不能直接导入到Firefox中，必须要把aucf格式转成Firefox支持的格式才行。</p>

<p>先把UC Browser和Firefox的书签格式都分析了一下。Firefox的格式非常简单，就是个HTML文件。UC的是二进制格式，文件以字符串android开头，接着是n个byte的信息，没有分析出来是啥。然后4个byte是书签的数目，再接着的n个byte没去分析，再下来就是每个书签的信息了。书签信息分两部分：名称和地址。都是第1个byte说明后面字符串的长度，字符串以00结尾。</p>

<p><code>
android    &lt;- 文件头
xxx...     &lt;- n个byte
xxxx       &lt;- 保存的书签数目
xxx...     &lt;- n个byte
xx         &lt;- 书签名称长度
xxx...     &lt;- 书签名称
xx         &lt;- 书签地址长度
xxx...     &lt;- 书签地址
</code></p>

<p>用文本文件打开时可以查看英文字符。书签的地址通常由英文字母组成，所以我们不需要再去分析整个aucf文件的格式，只要把所有书签地址提取出来就行了。下面就是完整的Ruby代码：</p>

<p>```</p>

<h1>aucf2ff.rb</h1>

<p>if ARGV.length != 1 then
  puts "USAGE: ruby aucf2ff.rb ucfavorite"
  exit
end</p>

<p>ucfavorite = ARGV[0]
if !FileTest.exist?(ucfavorite) then
  puts "File #{ucfavorite} was not found"
  exit
end</p>

<p>ff = File.new(ucfavorite.gsub(".aucf", "_ff.html"), "w")
ff.puts '&lt;!DOCTYPE NETSCAPE-Bookmark-file-1>'
ff.puts '<!-- This is an automatically generated file.'
ff.puts '     It will be read and overwritten.'
ff.puts '     DO NOT EDIT! -->'
ff.puts '<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">'
ff.puts '<TITLE>Bookmarks</TITLE>'
ff.puts '<H1>Bookmarks Menu</H1>'
ff.puts
ff.puts '<DL><p>'
ff.puts '    <DT><H3>UC Bookmarks</H3>'
ff.puts '    <DL><p>'</p>

<p>buffer = IO.read(ucfavorite)
index = buffer.index("<a href="http://">http://</a>")
favorites = buffer.slice(index, buffer.length - index)
favorites.split("<a href="http://">http://</a>").each do |fav|
  uri = ''
  fav.each_byte do |c|</p>

<pre><code>break if c == 00
uri += c.chr
</code></pre>

<p>  end
  if (!uri.empty?) then</p>

<pre><code>ff.puts '&lt;DT&gt;&lt;A HREF="http://' + uri + '" LAST_CHARSET="utf-8"&gt;' + uri + '&lt;/A&gt;'
</code></pre>

<p>  end
end</p>

<p>ff.puts '    </DL><p>'
ff.puts '</DL><p>'
ff.close
```</p>

<p>通过上面的程序就可以将UC Browser的书签转成Firefox格式，然后在Firefox中导入就可以了。</p>
]]></content>
  </entry>
  
</feed>
