<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: Stored Procedure | 乐者为王]]></title>
  <link href="http://codemany.com/tags/stored-procedure/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2014-09-07T21:15:51+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[批量更新表中某个字段的值到另一个字段的存储过程（MySQL版）]]></title>
    <link href="http://codemany.com/blog/2007/06/01/stored-procedure-batch-update-value-of-a-field-to-another-field-mysql-version/"/>
    <updated>2007-06-01T06:16:16+08:00</updated>
    <id>http://codemany.com/blog/2007/06/01/stored-procedure-batch-update-value-of-a-field-to-another-field-mysql-version</id>
    <content type="html"><![CDATA[<p>对博客做了一些修改，需要将entries表中的updatetime字段值替换成pubtime字段的值，为此写了一个MySQL存储过程，其中涉及Cursor的使用：
```
DELIMITER $$;</p>

<p>CREATE PROCEDURE sp_batch_replace()
BEGIN</p>

<pre><code>DECLARE pId varchar(48);
DECLARE pPubtime datetime;
DECLARE pDone bool;
DECLARE pCurosr CURSOR FOR SELECT id, pubtime FROM entries;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET pDone = true;

OPEN pCurosr;
    REPEAT
        FETCH pCurosr INTO pId, pPubtime;
        UPDATE entries SET updatetime = pPubtime WHERE id = pId;
        UNTIL pDone = true
    END REPEAT;
CLOSE pCurosr;
</code></pre>

<p>END$$</p>

<p>DELIMITER ;$$
```</p>

<p>第一次在SQLyog中写存储过程，在修改了存储过程后竟然不知道如何保存。点击File -> Save却是保存为另外一个文件，而不是直接保存修改的存储过程。经过多番尝试后发现按F5键就可以了。</p>
]]></content>
  </entry>
  
</feed>
