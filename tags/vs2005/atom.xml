<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: VS2005 | 乐者为王]]></title>
  <link href="http://codemany.com/tags/vs2005/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2014-09-20T15:46:37+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[修复wxWidgets Wizard for Visual Studio 2005/2008中的一个bug]]></title>
    <link href="http://codemany.com/blog/2008/10/16/fix-bug-wxwidgets-wizard-for-visual-studio-2005-and-2008/"/>
    <updated>2008-10-16T17:41:47+08:00</updated>
    <id>http://codemany.com/blog/2008/10/16/fix-bug-wxwidgets-wizard-for-visual-studio-2005-and-2008</id>
    <content type="html"><![CDATA[<p>前面发布的wxWidgets Wizard for Visual Studio 2005/2008存在一个bug，安装在VS2008中后不能创建新的wxWidgets项目。原因是没有将wxAppWiz.vsz文件中VsWizardEngine的版本号改为9.0。现在做了一些修改，修改后的代码如下：</p>

<p>```
procedure CurStepChanged(CurStep: TSetupStep);
var</p>

<pre><code>i: Integer;
Signature: String;
ConfigLine: String;
ConfigFile: String;
ConfigFileLines: TArrayOfString;
</code></pre>

<p>begin</p>

<pre><code>if CurStep = ssPostInstall then begin
    if (Pos('Visual Studio 9.0', ExpandConstant('{app}')) &gt; 0) then begin
        Signature := 'Wizard=VsWizard.VsWizardEngine';
        ConfigFile := ExpandConstant('{app}\VCProjects\wxAppWiz.vsz');
        LoadStringsFromFile(ConfigFile, ConfigFileLines);
        for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
            if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then begin
                ConfigFileLines[i] := 'Wizard=VsWizard.VsWizardEngine.9.0'
                SaveStringsToFile(ConfigFile, ConfigFileLines, False);
                break;
            end;
        end;
    end;

    Signature := 'wxWidgets';
    ConfigLine := 'wxWidgets|{1B027A40-8F43-11D0-8D11-00A0C91BC942}|#1043|70' + #13#10;
    ConfigFile := ExpandConstant('{app}\VCProjects\vc.vsdir');
    LoadStringsFromFile(ConfigFile, ConfigFileLines);
    for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
        if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then abort;
    end;
    SaveStringToFile(ConfigFile, ConfigLine, True);
end;
</code></pre>

<p>end;
```</p>

<p>代码下载：<a href="https://github.com/dohkoos/wxwizard">https://github.com/dohkoos/wxwizard</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序]]></title>
    <link href="http://codemany.com/blog/2008/05/21/complete-wxwidgets-wizard-for-visual-studio-2005-and-2008-install-program/"/>
    <updated>2008-05-21T15:28:16+08:00</updated>
    <id>http://codemany.com/blog/2008/05/21/complete-wxwidgets-wizard-for-visual-studio-2005-and-2008-install-program</id>
    <content type="html"><![CDATA[<p>两个晚上的时间，一边查资料一边学习，同时编写和测试安装脚本，最终完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序。现在不用配置就可以使用wxWidgets Wizard的代码框架生成功能了。安装制作程序采用的是Inno Setup，完整的安装脚本如下：</p>

<p>```</p>

<h1>define SrcImgsDir '..\VCWizards\images'</h1>

<h1>define SrcHtmlDir '..\VCWizards\html\1033'</h1>

<h1>define SrcScptDir '..\VCWizards\scripts\1033'</h1>

<h1>define SrcTempDir '..\VCWizards\templates\1033'</h1>

<h1>define TgtImgsDir 'VCWizards\AppWiz\wxWidgets\Application\images'</h1>

<h1>define TgtHtmlDir 'VCWizards\AppWiz\wxWidgets\Application\html\1033'</h1>

<h1>define TgtScptDir 'VCWizards\AppWiz\wxWidgets\Application\scripts\1033'</h1>

<h1>define TgtTempDir 'VCWizards\AppWiz\wxWidgets\Application\templates\1033'</h1>

<p>[Setup]
AppName=wxWidgets Application Wizard
AppVerName=wxWidgets Wizard 1.0.0
AppPublisher=dohkoos
DefaultDirName={pf32}\Microsoft Visual Studio 9.0\VC
DirExistsWarning=no
;Uninstallable=no
UninstallFilesDir={app}\VCWizards\AppWiz\wxWidgets
UninstallDisplayIcon={app}\VCProjects\wxAppWiz.ico
Compression=lzma
SolidCompression=yes</p>

<p>[Files]
Source: ..\VCProjects\wxAppWiz.ico; DestDir: {app}\VCProjects
Source: ..\VCProjects\wxAppWiz.vsz; DestDir: {app}\VCProjects
Source: ..\VCProjects\wxWidgets\wxWidgets.vsdir; DestDir: {app}\VCProjects\wxWidgets
Source: {#SrcImgsDir}*.gif; DestDir: {app}{#TgtImgsDir}
Source: {#SrcHtmlDir}*.htm; DestDir: {app}{#TgtHtmlDir}
Source: {#SrcHtmlDir}*.css; DestDir: {app}{#TgtHtmlDir}
Source: {#SrcScptDir}*.js; DestDir: {app}{#TgtScptDir}
Source: {#SrcTempDir}*.h; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}*.cpp; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}\readme.txt; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}\root.manifest; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}\Templates.inf; DestDir: {app}{#TgtTempDir}</p>

<p>[Code]
procedure CurStepChanged(CurStep: TSetupStep);
var</p>

<pre><code>i: Integer;
Signature: String;
ConfigLine: String;
ConfigFile: String;
ConfigFileLines: TArrayOfString;
</code></pre>

<p>begin</p>

<pre><code>if CurStep = ssPostInstall then begin
    Signature := 'wxWidgets';
    ConfigLine := 'wxWidgets|{1B027A40-8F43-11D0-8D11-00A0C91BC942}|#1043|70' + #13#10;
    ConfigFile := ExpandConstant('{app}\VCProjects\vc.vsdir');
    LoadStringsFromFile(ConfigFile, ConfigFileLines);
    for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
        if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then abort;
    end;
    SaveStringToFile(ConfigFile, ConfigLine, True);
end;
</code></pre>

<p>end;</p>

<p>procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);
var</p>

<pre><code>i: Integer;
j: Integer;
Signature: String;
ConfigFile: String;
ConfigFileLines, NewConfigFileLines: TArrayOfString;
</code></pre>

<p>begin</p>

<pre><code>if CurUninstallStep = usUninstall then begin
    Signature := 'wxWidgets';
    ConfigFile := ExpandConstant('{app}\VCProjects\vc.vsdir');
    LoadStringsFromFile(ConfigFile, ConfigFileLines);
    SetArrayLength(NewConfigFileLines, GetArrayLength(ConfigFileLines) - 1);
    j := 0;
    for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
        if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then begin
            continue;
        end else begin
            NewConfigFileLines[j] := ConfigFileLines[i];
            j := j + 1;
        end;
    end;
    SaveStringsToFile(ConfigFile, NewConfigFileLines, False);
end;
</code></pre>

<p>end;
```</p>

<p>代码下载：<a href="https://github.com/dohkoos/wxwizard">https://github.com/dohkoos/wxwizard</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[wxWidgets Wizard for Visual Studio 2005/2008]]></title>
    <link href="http://codemany.com/blog/2008/02/16/wxwidgets-wizard-for-visual-studio-2005-and-2008/"/>
    <updated>2008-02-16T08:13:19+08:00</updated>
    <id>http://codemany.com/blog/2008/02/16/wxwidgets-wizard-for-visual-studio-2005-and-2008</id>
    <content type="html"><![CDATA[<p>花了点时间为VS2005/VS2008写了一个简单的wxWidgets Wizard。本来想写的更完善一些再发布出来的，只是实在没有多少心思再继续地写下去了。而且该向导程序已经基本可以满足我自己的要求了。不过，如果以后有时间的话还是会继续完善它的。以下是我原本打算要实现的一些功能：</p>

<ol>
<li>支持创建对话框程序；</li>
<li>可以直接安装wxWidgets Wizard到VS2005中的安装程序；</li>
<li>集成wxWidgets Help文档到VS2005中；</li>
<li>实现代码智能提示功能；</li>
<li>可以在VS2005中直接编辑和编译XRC资源；</li>
<li>在向导过程中可以设置一些wxWidgets的高级特性（比如Menu Bar，Status Bar等）。</li>
</ol>


<p>截图：</p>

<p><img src="/uploads/wxwizard-default.png" title="wxwizard-default" ></p>

<p><img src="/uploads/wxwizard-apptype.png" title="wxwizard-apptype" ></p>

<p><img src="/uploads/wxwizard-generated-classes.png" title="wxwizard-generated-classes" ></p>

<p>代码下载：<a href="https://github.com/dohkoos/wxwizard">https://github.com/dohkoos/wxwizard</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MultiGet 1.1.4 for Windows]]></title>
    <link href="http://codemany.com/blog/2007/10/13/multiget-114-for-windows/"/>
    <updated>2007-10-13T23:03:46+08:00</updated>
    <id>http://codemany.com/blog/2007/10/13/multiget-114-for-windows</id>
    <content type="html"><![CDATA[<p>经过一整天的艰苦奋斗，终于成功地在VS2005中将MultiGet 1.1.4编译通过，让它在Windows平台上跑了起来。</p>

<p><img src="/uploads/multiget.png" title="multiget" ></p>

<p>在移植的过程中遇到了些问题，先是编译时出现如下错误：</p>

<p><code>
error C2011: 'fd_set' : 'struct' type redefinition
</code></p>

<p>问题的具体分析可以看<a href="http://blog.csdn.net/freefalcon/archive/2006/11/09/1374733.aspx">使用winsock2.h可能出现的两种编译错误</a>。解决方法有三种：</p>

<ol>
<li>在所有的<code>#include &lt;windows.h&gt;</code>前使用#define WIN32_LEAN_AND_MEAN；</li>
<li>调整<code>#include &lt;windows.h&gt;</code>和<code>#include &lt;winsock2.h&gt;</code>的顺序，将windows.h置于winsock2.h之前；</li>
<li>将和windows.h一起被引入的头文件winsock2.h删除。</li>
</ol>


<p>接着又碰到以下错误：</p>

<p><code>
error C2208: 'bool' : no members defined using this type
</code></p>

<p>在<code>#include &lt;windows.h&gt;</code>的后面添加<code>#include &lt;wx/msw/winundef.h&gt;</code>即可。</p>

<p><a href="/uploads/multiget-114-win32.zip" title="multiget-114-win32">代码下载</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Visual Studio 2005下wxWidgets-2.8.6开发环境的搭建]]></title>
    <link href="http://codemany.com/blog/2007/09/11/built-wxwidgets-286-development-environment-under-visual-studio-2005/"/>
    <updated>2007-09-11T15:27:51+08:00</updated>
    <id>http://codemany.com/blog/2007/09/11/built-wxwidgets-286-development-environment-under-visual-studio-2005</id>
    <content type="html"><![CDATA[<p>一、wxWidgets的下载、安装和编译</p>

<ol>
<li>去 <a href="http://www.wxwidgets.org/downloads/">http://www.wxwidgets.org/downloads/</a> 下载一个wxMSW版本的wxWidgets；</li>
<li>运行安装文件。在安装好后设置环境变量WXWIN，指向wxWidgets的安装目录。因为安装过程仅仅是把文件拷贝到指定的目录，所以还需要对wxWidgets进行编译；</li>
<li>进入$(WXWIN)/build/msw目录，用VS2005打开wx.dsw，提示是否进行项目转换，点确定。如果想要链接静态运行库，在编译前应该对每个项目进行设置，如下图：</li>
</ol>


<p><img src="/uploads/wxwidgets-compile.png" title="wxwidgets-compile" ></p>

<p>编译好后的wxWidgets会在$(WXWIN)/lib/vc_lib目录下生成一系列的lib文件，这些lib文件的名字遵循下面的命名规则：不依赖于GUI组件的库会以wxbase开头，紧跟着的是版本号，然后的字母表明这个库是否是编译为Unicode('u')或是否是编译为Debug('d')，名字中的最后部分是wxWidgets组件的名字。</p>

<p>注意：wxWidgets编译完后在$(WXWIN)/build/msw目录下会生成许多预编译头文件，占了很大的空间，如果确定以后不再编译wxWidgets库的话，可以考虑删掉。</p>

<p>二、设置开发环境</p>

<p>打开Tools -> Options -> Projects and Solutions -> VC++ Directories</p>

<ol>
<li>在Include files中加入$(WXWIN)/include和$(WXWIN)/include/msvc</li>
<li>在Library files中加入$(WXWIN)/lib/vc_lib</li>
</ol>


<p>三、创建wxWidgets项目</p>

<p>新建一个General -> Empty Project或Win32 -> Win32 Project项目，然后设置项目的一些属性，可以选择下面的其中一个来设置。譬如你如果打算使用Unicode，那么选择Unicode Debug或Unicode Release，如果你仅仅想调试程序而非发布，则只需要选择Debug设置。</p>

<p>```
Debug：
Project Properties -> General -> Character Set: No Set
Project Properties -> C/C++ -> Code Generation -> Runtime Library: Multi-threaded Debug (/MTd)
Project Properties -> Linker -> Input -> Additional Dependencies: wxbase28d.lib wxmsw28d_core.lib winmm.lib comctl32.lib rpcrt4.lib wsock32.lib oleacc.lib</p>

<p>Release：
Project Properties -> General -> Character Set: No Set
Project Properties -> C/C++ -> Code Generation -> Runtime Library: Multi-threaded (/MT)
Project Properties -> Linker -> Input -> Additional Dependencies: wxbase28.lib wxmsw28_core.lib winmm.lib comctl32.lib rpcrt4.lib wsock32.lib oleacc.lib</p>

<p>Unicode Debug：
Project Properties -> General -> Character Set: Use Unicode Character Set
Project Properties -> C/C++ -> Code Generation -> Runtime Library: Multi-threaded Debug (/MTd)
Project Properties -> Linker -> Input -> Additional Dependencies: wxbase28ud.lib wxmsw28ud_core.lib winmm.lib comctl32.lib rpcrt4.lib wsock32.lib oleacc.lib</p>

<p>Unicode Release：
Project Properties -> General -> Character Set: Use Unicode Character Set
Project Properties -> C/C++ -> Code Generation -> Runtime Library: Multi-threaded (/MT)
Project Properties -> Linker -> Input -> Additional Dependencies: wxbase28u.lib wxmsw28u_core.lib winmm.lib comctl32.lib rpcrt4.lib wsock32.lib oleacc.lib
```</p>

<p>问题：</p>

<p>1、编译时出现Cannot open include file: '../mswu/wx/setup.h': No such file or directory错误</p>

<p>这是因为项目属性的Character Set设置不正确，必须与使用的wxWidgets库的Character Set一致。</p>

<p>2、编译时出现MSVCRT.lib(MSVCRT.dll) : error LNK2005: _free already defined in LIBC.lib(free.obj)错误</p>

<p>这是因为没有连接正确的wxWidgets库，譬如Unicode Debug版本的项目就需要连接Unicode+Debug版本的wxWidgets库（库名后缀为'ud'的lib文件），或者是wxWidgets库和程序使用的Runtime Library不同。</p>

<p>3、运行是出现No Debugging Information对话框</p>

<p>将Project Properties -> Linker -> Debugging -> Generate Debug Info的值改成Yes (/DEBUG)。</p>
]]></content>
  </entry>
  
</feed>
