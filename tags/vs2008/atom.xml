<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: VS2008 | 乐者为王]]></title>
  <link href="http://codemany.com/tags/vs2008/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2014-08-13T19:18:25+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[修复wxWidgets Wizard for Visual Studio 2005/2008中的一个bug]]></title>
    <link href="http://codemany.com/blog/2008/10/16/repair-wxwidgets-wizard-for-visual-studio-20052008-a-bug/"/>
    <updated>2008-10-16T17:41:47+08:00</updated>
    <id>http://codemany.com/blog/2008/10/16/repair-wxwidgets-wizard-for-visual-studio-20052008-a-bug</id>
    <content type="html"><![CDATA[<p>前面发布的wxWidgets Wizard for Visual Studio 2005/2008存在一个bug，安装在VS2008中后不能创建新的wxWidgets项目。原因是没有将wxAppWiz.vsz文件中 VsWizardEngine的版本号改为9.0。现在做了一些修改，修改后的代码如下：</p>

<p>```
procedure CurStepChanged(CurStep: TSetupStep);
var</p>

<pre><code>i: Integer;
Signature: String;
VsdirLine: String;
ConfigFile: String;
ConfigFileLines: TArrayOfString;
</code></pre>

<p>begin</p>

<pre><code>if CurStep = ssPostInstall then begin
    if (Pos('Visual Studio 9.0', ExpandConstant('{app}')) &gt; 0) then begin
        Signature := 'Wizard=VsWizard.VsWizardEngine';
        ConfigFile := ExpandConstant('{app}\VCProjects\wxAppWiz.vsz');
        LoadStringsFromFile(ConfigFile, ConfigFileLines);
        for i := 0 to GetArrayLength(ConfigFileLines) - 1 do begin
            if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then begin
                ConfigFileLines[i] := 'Wizard=VsWizard.VsWizardEngine.9.0'
                SaveStringsToFile(ConfigFile, ConfigFileLines, False);
                break;
            end;
        end;
    end;

    Signature := 'wxWidgets';
    VsdirLine := 'wxWidgets|{1B027A40-8F43-11D0-8D11-00A0C91BC942}|#1043|70' + #13#10;
    ConfigFile:= ExpandConstant('{app}\VCProjects\vc.vsdir');
    LoadStringsFromFile(ConfigFile, ConfigFileLines);
    for i:= 0 to GetArrayLength(ConfigFileLines) - 1 do begin
        if (Pos(Signature, ConfigFileLines[i]) &gt; 0) then abort;
    end;
    SaveStringToFile(ConfigFile, VsdirLine, True);
end;
</code></pre>

<p>end;
```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序]]></title>
    <link href="http://codemany.com/blog/2008/05/21/completed-the-wxwidgets-wizard-for-visual-studio-20052008-installation-process/"/>
    <updated>2008-05-21T15:28:16+08:00</updated>
    <id>http://codemany.com/blog/2008/05/21/completed-the-wxwidgets-wizard-for-visual-studio-20052008-installation-process</id>
    <content type="html"><![CDATA[<p>两个晚上的时间，一边查资料一边学习，同时编写和测试安装脚本，最终完成了wxWidgets Wizard for Visual Studio 2005/2008的安装程序。现在不用配置就可以使用wxWidgets Wizard的代码框架生成功能了。安装制作程序采用的是Inno Setup，完整的安装脚本如下：</p>

<p>```</p>

<h1>define SrcImgsDir '..VCWizardsimages'</h1>

<h1>define SrcHtmlDir '..VCWizardshtml1033'</h1>

<h1>define SrcScptDir '..VCWizardsscripts1033'</h1>

<h1>define SrcTempDir '..VCWizardstemplates1033'</h1>

<h1>define TgtImgsDir 'VCWizardsAppWizwxWidgetsApplicationimages'</h1>

<h1>define TgtHtmlDir 'VCWizardsAppWizwxWidgetsApplicationhtml1033'</h1>

<h1>define TgtScptDir 'VCWizardsAppWizwxWidgetsApplicationscripts1033'</h1>

<h1>define TgtTempDir 'VCWizardsAppWizwxWidgetsApplicationtemplates1033'</h1>

<p>[Setup]
AppName=wxWidgets Application Wizard
AppVerName=wxWidgets Wizard 1.0.0
AppPublisher=<a href="http://codemany.com">http://codemany.com</a>
DefaultDirName={pf32}Microsoft Visual Studio 9.0VC
DirExistsWarning=no
;Uninstallable=no
UninstallFilesDir={app}VCProjectswxWidgets
UninstallDisplayIcon={app}VCProjectswxAppWiz.ico
Compression=lzma
SolidCompression=yes</p>

<p>[Files]
Source: ..VCProjectswxAppWiz.ico; DestDir: {app}VCProjects
Source: ..VCProjectswxAppWiz.vsz; DestDir: {app}VCProjects
Source: ..VCProjectswxWidgetswxWidgets.vsdir; DestDir: {app}VCProjectswxWidgets
Source: {#SrcImgsDir}<em>.gif; DestDir: {app}{#TgtImgsDir}
Source: {#SrcHtmlDir}</em>.htm; DestDir: {app}{#TgtHtmlDir}
Source: {#SrcHtmlDir}<em>.css; DestDir: {app}{#TgtHtmlDir}
Source: {#SrcScptDir}</em>.js; DestDir: {app}{#TgtScptDir}
Source: {#SrcTempDir}<em>.h; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}</em>.cpp; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}readme.txt; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}root.manifest; DestDir: {app}{#TgtTempDir}
Source: {#SrcTempDir}Templates.inf; DestDir: {app}{#TgtTempDir}</p>

<p>[Code]
procedure CurStepChanged(CurStep: TSetupStep);
var</p>

<pre><code>i: Integer;
Signature: String;
VsdirLine: String;
VcVsdirFile: String;
VcVsdirFileLines: TArrayOfString;
</code></pre>

<p>begin</p>

<pre><code>if CurStep = ssPostInstall then begin
    Signature := 'wxWidgets';
    VsdirLine := 'wxWidgets|{1B027A40-8F43-11D0-8D11-00A0C91BC942}|#1043|70' + #13#10;
    VcVsdirFile := ExpandConstant('{app}VCProjectsvc.vsdir');
    LoadStringsFromFile(VcVsdirFile, VcVsdirFileLines);
    for i := 0 to GetArrayLength(VcVsdirFileLines) - 1 do begin
        if (Pos(Signature, VcVsdirFileLines[i]) &gt; 0) then abort;
    end;
    SaveStringToFile(VcVsdirFile, VsdirLine, True);
end;
</code></pre>

<p>end;</p>

<p>procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);
var</p>

<pre><code>i, j: Integer;
Signature: String;
VcVsdirFile: String;
VcVsdirFileLines, NewVcVsdirFileLines: TArrayOfString;
</code></pre>

<p>begin</p>

<pre><code>if CurUninstallStep = usUninstall then begin
    Signature := 'wxWidgets';
    VcVsdirFile := ExpandConstant('{app}VCProjectsvc.vsdir');
    LoadStringsFromFile(VcVsdirFile, VcVsdirFileLines);
    SetArrayLength(NewVcVsdirFileLines, GetArrayLength(VcVsdirFileLines) - 1);
    j := 0;
    for i := 0 to GetArrayLength(VcVsdirFileLines) - 1 do begin
        if (Pos(Signature, VcVsdirFileLines[i]) &gt; 0) then begin
            continue;
        end else begin
            NewVcVsdirFileLines[j] := VcVsdirFileLines[i];
            j := j + 1;
        end;
    end;
    SaveStringsToFile(VcVsdirFile, NewVcVsdirFileLines, False);
end;
</code></pre>

<p>end;
```</p>

<p>下一步准备将wxWidgets的Help文档集成到VS2005/VS2008中。</p>
]]></content>
  </entry>
  
</feed>
