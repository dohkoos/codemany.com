<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: TRW2000 | 乐者为王]]></title>
  <link href="http://codemany.com/tags/trw2000/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2017-11-14T18:59:18+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[练习破解Brad Soblesky的Crackme]]></title>
    <link href="http://codemany.com/blog/learn-to-crack-brad-soblesky-crackme/"/>
    <updated>2005-03-26T00:26:09+08:00</updated>
    <id>http://codemany.com/blog/learn-to-crack-brad-soblesky-crackme</id>
    <content type="html"><![CDATA[<p><a href="/uploads/crackme.zip" title="crackme.zip">Crackme程序</a></p>

<p>这次破解参考了wind[CCG]写的《Crackme-Brad Soblesky的Crackme程序破解》文章。因为我用的是Windows 2000操作系统，TRW2000不能在上面使用，所以我用SoftICE 4.05 来破解。</p>

<p>用PEiD查看这个程序，发现是用VC++ 6.0编写的且没加过壳，所以用W32Dasm反汇编。打开Functions/Imports查看它调用的函数，能够看见KERNEL32.lstrcmpA。双击它可以看到如下程序段：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">:00401585 8d4de4 lea ecx, dword ptr [ebp-1c]
:00401588 51 push ecx
:00401589 8d55f4 lea edx, dword ptr [ebp-0c]
:0040158c 52 push edx

* reference to: kernel32.lstrcmpa, ord:02fch
:0040158d ff1500204000 call dword ptr [00402000]
:00401593 85c0 test eax, eax                      -&gt; 典型的判断，肯定是这里了

:00401595 7516 jne 004015ad                       -&gt; 看见这个跳转了吗
:00401597 6a40 push 00000040
</code></pre></div>
<ol>
<li>启动SoftICE，然后运行Crackme程序；</li>
<li>在文本框中输入78787878；</li>
<li>Ctrl+D 来到SoftICE中，输入bpx lstrcmpA，按回车后用Ctrl+D命令返回Crackme；</li>
<li>按check，程序中断；</li>
<li>按F11回到调用lstrcmpA的地方，发现CS寄存器的值为001b，输入bpx 001b: 00401585，按回车后用Ctrl+D命令返回Crackme；</li>
<li>按check，程序中断；</li>
<li>F10来到如下程序段：</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">:00401585 8d4de4 lea ecx, dword ptr [ebp-1c]
:00401588 51 push ecx                             -&gt; 在此处用d ecx就可以看到注册码了
:00401589 8d55f4 lea edx, dword ptr [ebp-0c]
:0040158c 52 push edx
</code></pre></div>
<p>注册码：<code>&lt;BrD-SoB&gt;</code></p>
]]></content>
  </entry>
  
</feed>
