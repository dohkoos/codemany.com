<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: iBatis | 乐者为王]]></title>
  <link href="http://codemany.com/tags/ibatis/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2014-08-03T22:17:08+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[在iBatis中如何将JavaBean的boolean值映射成数据库的CHAR(Y或N)值]]></title>
    <link href="http://codemany.com/blog/2006/05/29/in-ibatis-how-will-the-boolean-value-javabean-mapping-into-the-database-char-y-or-n-value/"/>
    <updated>2006-05-29T12:15:40+08:00</updated>
    <id>http://codemany.com/blog/2006/05/29/in-ibatis-how-will-the-boolean-value-javabean-mapping-into-the-database-char-y-or-n-value</id>
    <content type="html"><![CDATA[<p>Spring 1.2.8<br />iBatis 2.1.5<br /><br />&#21442;&#32771;文&#29486;：<br />http://opensource.atlassian.com/confluence/oss/display/IBATIS/How+do+I+use+a+Custom+Type+Handler+with+complex+property+or+Type+Safe+Enumeration<br />http://opensource.atlassian.com/confluence/oss/display/IBATIS/How+do+I+use+a+BLOB+or+CLOB<br />http://java.mblogger.cn/wuyu/posts/8416.aspx<br />http://www.mail-archive.com/user-java@ibatis.apache.org/msg03985.html<br />http://www.mail-archive.com/user-java@ibatis.apache.org/msg04107.html<br /><br /><br />JavaBean的boolean&#20540;&#26144;&#23556;到&#25968;&#25454;&#24211;的&#40664;&#35748;&#20540;是0&#21644;1，不是&#38750;&#24120;&#30452;&#35266;。现在&#24076;&#26395;能将boolean&#20540;&#26144;&#23556;成&#20026;Y&#21644;N，iBatis 2.0.5以后<br />的版本&#25552;&#20379;了TypeHandlerCallback，可以&#29992;来&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;。<br /><br />首先&#23450;&#20041;&#25968;&#25454;&#24211;table：<br /><br />user (<br />    username varchar(40),<br />    password varchar(255),<br />    enabled char(1),<br />    PRIMARY KEY (username)<br />);<br /><br />YesNoTypeHandlerCallback&#23454;现&#20195;&#30721;：<br /><br />public class YesNoTypeHandlerCallback implements TypeHandlerCallback {<br /><br />    public void setParameter(ParameterSetter setter, Object parameter) throws SQLException {<br />        if (parameter == null) {<br />            setter.setString("");<br />        } else {<br />            Boolean b = (Boolean)parameter;<br />            if (b.booleanValue()) {<br />                setter.setString("Y");<br />            } else {<br />                setter.setString("N");<br />            }<br />        }<br />    }<br /><br />    public Object getResult(ResultGetter getter) throws SQLException {<br />        String string = getter.getString();<br />        if (string == null) {<br />            return null;<br />        } else if ("Y".equalsIgnoreCase(string)) {<br />            return new Boolean(true);<br />        } else {<br />            return new Boolean(false);<br />        }<br />    }<br /><br />    public Object valueOf(String s) {<br />        return s;<br />    }<br />}<br /><br />下&#38754;是SQL Map Config：<br /><br /><sqlMapConfig><br />    <typeHandler jdbcType="CHAR" javaType="boolean"<br />                 callback="org.company.project.dao.support.YesNoTypeHandlerCallback" /><br /><br />    <sqlMap resource="org/company/project/dao/impl/sql/UserSQL.xml" /><br /></sqlMapConfig><br /><br />jdbcType="CHAR" javaType="boolean"&#24517;&#39035;&#26377;，&#21542;&#21017;YesNoTypeHandlerCallback.setParameter()不会&#34987;&#35843;&#29992;。<br /><br />UserSQL.xml&#37096;&#20998;：<br /><br /><typeAlias alias="user" type="org.company.project.model.User" /><br /><br /><resultMap id="userResult" class="user"><br />    <result property="username" column="username" /><br />    <result property="password" column="password" /><br />    <result property="enabled" column="enabled" jdbcType="CHAR" javaType="boolean" /><br /></resultMap><br /><br /><select id="getUser" parameterClass="string" resultMap="userResult"><br />&lt;![CDATA[<br />    SELECT username, password, enabled<br />    FROM user WHERE username = #username#<br />]]&gt;<br /></select><br /><br /><insert id="addUser" parameterClass="user"><br />&lt;![CDATA[<br />    INSERT INTO user (username, password, enabled)<br />    VALUES (#username#, #password#, #enabled,jdbcType=CHAR,javaType=boolean#)<br />]]&gt;<br /></insert><br /><br />jdbcType="CHAR" javaType="boolean"&#24517;&#39035;&#26377;，&#21542;&#21017;YesNoTypeHandlerCallback.getResult()不会&#34987;&#35843;&#29992;；<br />#enabled,jdbcType=CHAR,javaType=boolean#&#20063;&#24517;&#39035;&#36825;样写，&#21542;&#21017;YesNoTypeHandlerCallback.setParameter()<br />不会&#34987;&#35843;&#29992;，写成#enabled:CHAR#&#21644;#enabled#&#37117;&#27809;&#26377;&#20160;么&#20316;&#29992;。</p>

]]></content>
  </entry>
  
</feed>
