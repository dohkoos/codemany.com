<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: SoftICE | 乐者为王]]></title>
  <link href="http://codemany.com/tags/softice/atom.xml" rel="self"/>
  <link href="http://codemany.com/"/>
  <updated>2015-10-27T21:56:13+08:00</updated>
  <id>http://codemany.com/</id>
  <author>
    <name><![CDATA[dohkoos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[练习破解Andrnalin的Crackme]]></title>
    <link href="http://codemany.com/blog/learn-to-crack-andrnalin-crackme/"/>
    <updated>2005-04-05T21:32:19+08:00</updated>
    <id>http://codemany.com/blog/learn-to-crack-andrnalin-crackme</id>
    <content type="html"><![CDATA[<p>拿到这个程序，用PEiD查看这个程序，发现是用Microsoft Visual Basic 5.0编写的且没有加过壳，所以用W32Dasm反汇编。通过Functions/Imports查看它调用的函数，能够看见MSVBVM50!__vbaStrCmp字样。</p>

<ol>
<li>启动SoftICE，然后运行Crackme程序；</li>
<li>在文本框中输入12345678；</li>
<li>Ctrl+D来到SoftICE中，输入bpx __vbaStrCmp，按回车后用Ctrl+D命令返回Crackme；</li>
<li>点击OK，程序被SoftICE中断；</li>
<li>按F12回到调用__vbaStrCmp的地方；</li>
<li>按F6切换到代码窗口，移动光标，直到代码窗口中出现如下程序段：</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">001B:00401D70                MOV ECX, [EBP-28]
001B:00401D73                PUSH ECX
001B:00401D74                PUSH 00401A54
001B:00401D79                CALL [MSVBVM50!__vbaStrCmp]
</code></pre></div>
<p>因此可以知道__vbaStrCmp比较的是ECX和00401A54所指向的字符串。记下00401A54这个值，然后重复步骤1、2、3、4。接着查看ECX和00401a54指向的内容就可以知道正确的key了。</p>

<p>d ecx的显示如下：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">0023:0013CC1C 31 00 32 00 33 00 34 00-35 00 36 00 37 00 38 00 1.2.3.4.5.6.7.8.
0023:0013CC2C 00 00 72 00 61 00 6D 00-46 00 69 00 79 00 05 00 ..r.a.m.F.i.y...
</code></pre></div>
<p>d 401a54的显示如下：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">0023:00401A54 53 00 79 00 6E 00 54 00-61 00 58 00 20 00 32 00 S.y.n.T.a.X. .2.
0023:00401A64 6F 00 6F 00 31 00 00 00-4C 00 00 00 52 00 69 00 o.o.1...L...R.i.
</code></pre></div>
<p>12345678是我们输入的key，所以正确的key是SynTaX 2oo1（注意中间的空格）。</p>

<p>注意：如果你是在破解VB6程序，你应该在断点前加上msvbvm60!。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[练习破解Brad Soblesky的Crackme]]></title>
    <link href="http://codemany.com/blog/learn-to-crack-brad-soblesky-crackme/"/>
    <updated>2005-03-26T00:26:09+08:00</updated>
    <id>http://codemany.com/blog/learn-to-crack-brad-soblesky-crackme</id>
    <content type="html"><![CDATA[<p><a href="/uploads/crackme.zip" title="crackme.zip">Crackme程序</a></p>

<p>这次破解参考了wind[CCG]写的《Crackme-Brad Soblesky的Crackme程序破解》文章。因为我用的是Windows 2000操作系统，TRW2000不能在上面使用，所以我用SoftICE 4.05 来破解。</p>

<p>用PEiD查看这个程序，发现是用VC++ 6.0编写的且没加过壳，所以用W32Dasm反汇编。打开Functions/Imports查看它调用的函数，能够看见KERNEL32.lstrcmpA。双击它可以看到如下程序段：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">:00401585 8d4de4 lea ecx, dword ptr [ebp-1c]
:00401588 51 push ecx
:00401589 8d55f4 lea edx, dword ptr [ebp-0c]
:0040158c 52 push edx

* reference to: kernel32.lstrcmpa, ord:02fch
:0040158d ff1500204000 call dword ptr [00402000]
:00401593 85c0 test eax, eax                      -&gt; 典型的判断，肯定是这里了

:00401595 7516 jne 004015ad                       -&gt; 看见这个跳转了吗
:00401597 6a40 push 00000040
</code></pre></div>
<ol>
<li>启动SoftICE，然后运行Crackme程序；</li>
<li>在文本框中输入78787878；</li>
<li>Ctrl+D 来到SoftICE中，输入bpx lstrcmpA，按回车后用Ctrl+D命令返回Crackme；</li>
<li>按check，程序中断；</li>
<li>按F11回到调用lstrcmpA的地方，发现CS寄存器的值为001b，输入bpx 001b: 00401585，按回车后用Ctrl+D命令返回Crackme；</li>
<li>按check，程序中断；</li>
<li>F10来到如下程序段：</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">:00401585 8d4de4 lea ecx, dword ptr [ebp-1c]
:00401588 51 push ecx                             -&gt; 在此处用d ecx就可以看到注册码了
:00401589 8d55f4 lea edx, dword ptr [ebp-0c]
:0040158c 52 push edx
</code></pre></div>
<p>注册码：<BrD-SoB></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SoftICE 4.05入门指南]]></title>
    <link href="http://codemany.com/blog/getting-started-with-softice-405/"/>
    <updated>2005-03-20T22:18:06+08:00</updated>
    <id>http://codemany.com/blog/getting-started-with-softice-405</id>
    <content type="html"><![CDATA[<p>首先，在VC++ 6.0中新建工程Hello，建立源文件Hello.c，编译链接成可执行的Hello.exe文件。</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#include &lt;windows.h&gt;

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, PSTR szCmdLine, int iCmdShow)
{
    MessageBox(NULL, TEXT(&quot;Hello, world!&quot;), TEXT(&quot;Crack&quot;), 0);
    return 0;
}
</code></pre></div>
<p>然后安装SoftICE 4.05 for Windows 2000，选择manual启动方式。在菜单中选择Start SoftICE快捷方式启动SoftICE。</p>

<p>接着双击Hello.exe程序，按Ctrl+D呼叫出SoftICE，输入bpx MessageBox后按回车键（记住：一定要按回车键啊）。如果提示“Symbol not Defined (xxx)”，可以打开WINNT\system32\winice.dat文件，将所有DLL前的分号去除，然后重新启动SoftICE并且重复上述步骤。</p>

<p>最后按Ctrl+D返回，双击Hello.exe文件，此时就会发现设置的断点被SoftICE中断住了。</p>
]]></content>
  </entry>
  
</feed>
